(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1910],{88281:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/buy/detail",function(){return n(60310)}])},90231:function(e,t,n){"use strict";n.d(t,{Gh:function(){return l},ZP:function(){return c},oF:function(){return a}});var s=n(11802),r=n(36100);n(53233);let i=(0,r.ad)(s.Z);async function c(e,t){let n=null,s=null;try{let s={name:t.name,createAt:r.EK.fromDate(new Date(t.createAt)),products:t.products,discount:""!==t.discount?t.discount:0,shippingCost:""!==t.shippingCost?t.shippingCost:0,user_id:t.user_id,totalCost:t.totalCost,status:"สำเร็จ"};n=await (0,r.ET)((0,r.hJ)(i,e),s),console.log("สร้างรายการซื้อสำเร็จ",n)}catch(e){console.error("เกิดข้อผิดพลาดในการสร้างรายการซื้อ:",s=e)}return{result:n,error:s}}async function l(e,t,n){let s=null,c=null;try{let c={name:n.name,createAt:r.EK.fromDate(new Date(n.createAt)),products:n.products,discount:""!==n.discount?n.discount:0,shippingCost:""!==n.shippingCost?n.shippingCost:0,user_id:n.user_id,totalCost:n.totalCost,status:"สำเร็จ"};s=await (0,r.pl)((0,r.JU)(i,e,t),c,{merge:!0}),console.log("แก้ไขข้อมูลเอกสารสำเร็จ:",s)}catch(e){console.error("เกิดข้อผิดพลาดในการแก้ไขข้อมูลเอกสาร:",c=e)}return{result:s,error:c}}async function a(e,t){let n=null,s=null;try{n=await (0,r.pl)((0,r.JU)(i,e,t),{status:"ยกเลิก"},{merge:!0}),console.log("ยกเลิกรายการสำเร็จ",n)}catch(e){console.error("เกิดข้อผิดพลาดในการยกเลิกรายการข้อมูล:",s=e)}return{result:n,error:s}}},53233:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var s=n(11802),r=n(36100);let i=(0,r.ad)(s.Z);async function c(e,t,n){let s=null,c=null;if(n.catalog_id){let e=(0,r.JU)(i,"catalog",n.catalog_id);n.catalog_id=e}try{s=await (0,r.pl)((0,r.JU)(i,e,t),n,{merge:!0}),console.log("แก้ไขสำเร็จ",s)}catch(e){console.error("เกิดข้อผิดพลาดในการแก้ไขข้อมูล:",c=e)}return{result:s,error:c}}},60310:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var s=n(85893),r=n(9913),i=n(68239),c=n(98102),l=n(89755),a=n(53816),o=n(46901),d=n(22430),x=n(58703),h=n(15861),p=n(83321),u=n(87357),j=n(86886),Z=n(72882),m=n(90629),f=n(7906),g=n(53184),b=n(295),y=n(93946),w=n(57922),C=n(11163),_=n(67294),v=n(96471),S=n(99061),E=n(79944),N=n(49925),z=n(16829),A=n(75503),k=n(90813),F=n(90231);function P(){let e=(0,i.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}},typography:{text:{fontSize:"1.2rem",padding:"1vw",width:"10rem"},data:{fontSize:"1.2rem",fontWeight:"600",whiteSpace:"pre-line"}}}),t=(0,z.Z)(c.Z)(e=>{let{theme:t}=e;return{["&.".concat(l.Z.head)]:{backgroundColor:"#018294",color:t.palette.common.white},["&.".concat(l.Z.body)]:{fontSize:14}}}),n=(0,z.Z)(a.Z)(e=>{let{theme:t}=e;return{"&:nth-of-type(odd)":{backgroundColor:t.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}}),P=()=>{window.history.back()},J=(0,C.useRouter)(),W=JSON.parse(J.query.id),[D,R]=(0,_.useState)([]),[T,O]=(0,_.useState)(""),[B,U]=(0,_.useState)("");(0,_.useEffect)(()=>{q()},[]);let{userData:H}=(0,_.useContext)(E.S);(0,_.useEffect)(()=>{if(void 0!==D){let e=H.find(e=>e.id===D.user_id);e&&(O(e.name),U(e.tel))}},[D,H]);let q=async()=>{let{result:e,error:t}=await (0,N.ZP)("buy",W);if(t)console.error("Error fetching document:",t);else if(e){let t=e.data();R(t)}},{productData:K}=(0,_.useContext)(S.H),X=D.products&&Array.isArray(D.products)?D.products.map((e,t)=>{var n;return n=e.product_exp,{No:t+1,product_exp:n,product_id:e.product_id,product_name:e.product_name,product_size:e.product_size}}):[],[G,L]=(0,_.useState)([]),I=e=>{L(t=>({...t,[e]:!t[e]}))},[M,Q]=(0,_.useState)(null),[V,Y]=(0,_.useState)(!1),$=(e,t)=>{"clickaway"!==t&&Y(!1)},ee=async()=>{let e=await (0,F.oF)("buy",W);e?(Q((0,s.jsx)(o.Z,{severity:"success",onClose:$,children:"ยกเลิกรายการสำเร็จ"})),Y(!0),setTimeout(()=>{P()},500)):(Q((0,s.jsx)(o.Z,{severity:"error",onClose:$,children:"ผิดพลาด! ไม่สามารถยกเลิกรายการได้"})),Y(!0))};return(0,s.jsx)(r.Z,{children:(0,s.jsxs)(d.Z,{theme:e,children:[(0,s.jsx)(x.Z,{open:V,autoHideDuration:6e3,onClose:$,children:M}),(0,s.jsx)(h.Z,{sx:{fontSize:"2rem",fontWeight:"600",mt:5},children:"รายละเอียดรายการซื้อ"}),(0,s.jsxs)(p.Z,{sx:{color:"#018294",bgcolor:"white",fontWeight:"bold",borderRadius:"50px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},onClick:P,children:[(0,s.jsx)(v.Z,{}),(0,s.jsx)(h.Z,{children:" ย้อนกลับ"})]}),(0,s.jsxs)(u.Z,{sx:{display:"flex",justifyContent:{xl:"flex-end"}},children:[(0,s.jsx)(p.Z,{variant:"contained",color:"success",sx:{mr:2,mb:2,mt:2},onClick:()=>{J.push({pathname:"edit",query:{id:JSON.stringify(W)}})},children:"แก้ไขรายการ"}),"สำเร็จ"===D.status?(0,s.jsx)(p.Z,{variant:"contained",color:"error",sx:{mr:2,mb:2,mt:2},onClick:ee,children:"ยกเลิกรายการ"}):null]}),(0,s.jsx)(u.Z,{children:(0,s.jsxs)(j.ZP,{container:!0,spacing:1.5,sx:{mb:5},children:[(0,s.jsx)(j.ZP,{item:!0,xs:12,lg:6,children:(0,s.jsxs)(u.Z,{sx:{bgcolor:"#fff",borderBottom:"1px solid #ccc",borderRadius:"10px",boxShadow:"rgba(6, 24, 44, 0.4) 0px 0px 0px 2px, rgba(6, 24, 44, 0.65) 0px 4px 6px -1px, rgba(255, 255, 255, 0.08) 0px 1px 0px inset"},children:[(0,s.jsx)(h.Z,{sx:{fontSize:"1.5rem",fontWeight:"600",p:2},children:"ข้อมูล"}),(0,s.jsxs)(u.Z,{sx:{display:{md:"flex"},m:2},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"ชื่อรายการ:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsx)(h.Z,{variant:"data",children:D.name})})]}),(0,s.jsxs)(u.Z,{sx:{display:{md:"flex"},m:2},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"วันที่:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsx)(h.Z,{variant:"data",children:D.createAt?D.createAt.toDate().toLocaleString("th-TH",{dateStyle:"long"}):""})})]}),(0,s.jsxs)(u.Z,{sx:{display:{md:"flex"},m:2,pt:1,pb:1,bgcolor:"สำเร็จ"===D.status?"#A9C470":"#FE616A"},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"สถานะรายการ:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsx)(h.Z,{variant:"data",children:D.status})})]})]})}),(0,s.jsx)(j.ZP,{item:!0,xs:12,lg:6,children:(0,s.jsxs)(u.Z,{sx:{bgcolor:"#fff",borderBottom:"1px solid #ccc",borderRadius:"10px",boxShadow:"rgba(6, 24, 44, 0.4) 0px 0px 0px 2px, rgba(6, 24, 44, 0.65) 0px 4px 6px -1px, rgba(255, 255, 255, 0.08) 0px 1px 0px inset"},children:[(0,s.jsx)(h.Z,{sx:{fontSize:"1.5rem",fontWeight:"600",p:2},children:"ผู้สร้าง"}),(0,s.jsxs)(u.Z,{sx:{display:{md:"flex"},m:2},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"ชื่อ:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsx)(h.Z,{variant:"data",children:T})})]}),(0,s.jsxs)(u.Z,{sx:{display:{md:"flex"},m:2},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"เบอร์ติดต่อ:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsx)(h.Z,{variant:"data",children:B})})]}),(0,s.jsx)(u.Z,{sx:{display:{md:"flex"},m:2,p:1},children:(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text"})})})]})}),(0,s.jsx)(j.ZP,{item:!0,xs:12,children:(0,s.jsxs)(u.Z,{sx:{bgcolor:"#fff",borderBottom:"1px solid #ccc",borderRadius:"10px",boxShadow:"rgba(6, 24, 44, 0.4) 0px 0px 0px 2px, rgba(6, 24, 44, 0.65) 0px 4px 6px -1px, rgba(255, 255, 255, 0.08) 0px 1px 0px inset"},children:[(0,s.jsx)(h.Z,{sx:{fontSize:"1.5rem",fontWeight:"600",p:2},children:"สินค้า"}),(0,s.jsx)(u.Z,{sx:{m:2},children:(0,s.jsx)(Z.Z,{component:m.Z,sx:{borderRadius:"10px"},children:(0,s.jsxs)(f.Z,{sx:{minWidth:700},children:[(0,s.jsx)(g.Z,{children:(0,s.jsxs)(a.Z,{children:[(0,s.jsx)(t,{align:"center"}),(0,s.jsx)(t,{align:"center",children:"No."}),(0,s.jsx)(t,{align:"center",children:"ชื่อสินค้า"}),(0,s.jsx)(t,{align:"center",children:"รวม(บาท)"})]})}),(0,s.jsx)(b.Z,{children:X.map(e=>(0,s.jsxs)(_.Fragment,{children:[(0,s.jsxs)(n,{children:[(0,s.jsx)(t,{align:"center",children:(0,s.jsx)(y.Z,{size:"small",onClick:()=>I(e.No),children:G[e.No]?(0,s.jsx)(k.Z,{}):(0,s.jsx)(A.Z,{})})}),(0,s.jsx)(t,{align:"center",children:e.No}),(0,s.jsx)(t,{align:"center",children:e.product_name}),(0,s.jsx)(t,{align:"center",children:e.product_size.map(e=>{let t=parseFloat(e.amount)*parseFloat(e.cost);return t}).reduce((e,t)=>e+t,0)})]}),(0,s.jsx)(a.Z,{children:(0,s.jsx)(c.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:(0,s.jsx)(w.Z,{in:G[e.No],timeout:"auto",unmountOnExit:!0,children:(0,s.jsx)(u.Z,{children:(0,s.jsxs)(f.Z,{children:[(0,s.jsx)(g.Z,{children:(0,s.jsxs)(a.Z,{children:[(0,s.jsx)(c.Z,{align:"center",children:"รูปแบบสินค้า"}),(0,s.jsx)(c.Z,{align:"center",children:"จำนวน"}),(0,s.jsx)(c.Z,{align:"center",children:"ราคาต่อหน่วย(บาท)"}),(0,s.jsx)(c.Z,{align:"center",children:"รวม(บาท)"})]})}),(0,s.jsx)(b.Z,{children:e.product_size.map((e,t)=>(0,s.jsxs)(a.Z,{children:[(0,s.jsx)(c.Z,{align:"center",children:e.size}),(0,s.jsx)(c.Z,{align:"center",children:e.amount}),(0,s.jsx)(c.Z,{align:"center",children:e.cost}),(0,s.jsx)(c.Z,{align:"center",children:parseFloat(e.cost)*parseFloat(e.amount)})]},t))})]})})})})})]},e.No))})]})})}),(0,s.jsxs)(u.Z,{children:[(0,s.jsxs)(u.Z,{sx:{display:{xs:"flex"},m:2,justifyContent:{xs:"space-between",md:"flex-start"}},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"ส่วนลด:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsxs)(h.Z,{variant:"data",children:[D.discount," บาท"]})})]}),(0,s.jsxs)(u.Z,{sx:{display:{xs:"flex"},m:2,justifyContent:{xs:"space-between",md:"flex-start"}},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"ค่าส่ง:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsxs)(h.Z,{variant:"data",children:[D.shippingCost," บาท"]})})]}),(0,s.jsxs)(u.Z,{sx:{display:{xs:"flex"},m:2,justifyContent:{xs:"space-between",md:"flex-start"},bgcolor:"#EAE4E7",pt:2,pb:2},children:[(0,s.jsx)(u.Z,{sx:{width:"12rem"},children:(0,s.jsx)(h.Z,{variant:"text",children:"มูลค่ารวมสุทธิ:"})}),(0,s.jsx)(u.Z,{children:(0,s.jsxs)(h.Z,{variant:"data",children:[D.totalCost," บาท"]})})]})]})]})})]})})]})})}}},function(e){e.O(0,[2607,7609,5675,6185,1283,3717,3914,4792,9254,8242,9913,9774,2888,179],function(){return e(e.s=88281)}),_N_E=e.O()}]);