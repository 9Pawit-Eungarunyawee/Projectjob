(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6401],{66312:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/product/addproduct",function(){return t(71907)}])},34300:function(e,l,t){"use strict";t.d(l,{RS:function(){return c},SR:function(){return u},ZP:function(){return i},cB:function(){return o}});var s=t(11802),a=t(36100),r=t(49925);let n=(0,a.ad)(s.Z);async function i(e,l){let t=null,s=null,r=(0,a.JU)(n,"catalog",l.catalog_id);try{let s=l.img?l.img:"",i={name:l.name,catalog_id:r,detail:l.detail,flim:l.flim,grade:l.grade,lot:l.lot,status:l.status,img:s,area:l.area,productSizes:l.productSizes,delete:null,create:{createAt:(0,a.Bt)(),createBy:l.user_id},update:null};t=await (0,a.ET)((0,a.hJ)(n,e),i),console.log("เพิ่มข้อมูลสำเร็จ",t)}catch(e){console.error("เกิดข้อผิดพลาดในการเพิ่มข้อมูล:",s=e)}return{result:t,error:s}}let u=async(e,l)=>{let t=null,s=null,r=(0,a.JU)(n,e,l);try{await (0,a.oe)(r),console.log("ลบข้อมูลสำเร็จ"),t="Success"}catch(e){console.error("เกิดข้อผิดพลาดในการลบข้อมูล:",s=e)}return{result:t,error:s}};async function c(e,l){let t=null,s=null;try{let s=await (0,r.ZP)("users",l.user_id);if(s.result&&s.result.exists){let r=s.result.data().name,i={delete:{deleteAt:(0,a.Bt)(),deleteBy:r}};t=await (0,a.pl)((0,a.JU)(n,e,l.id),i,{merge:!0}),console.log("Soft delete สำเร็จ",t)}else console.log("หาข้อมูล user ใน soft del ไม่เจอ")}catch(e){console.error("เกิดข้อผิดพลาดในการ soft delete:",s=e)}return{result:t,error:s}}async function o(e,l){let t=null,s=null;try{t=await (0,a.pl)((0,a.JU)(n,e,l),{delete:null},{merge:!0}),console.log("restoreData สำเร็จ",t)}catch(e){console.error("เกิดข้อผิดพลาดในการ restoreData:",s=e)}return{result:t,error:s}}},71907:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return _}});var s=t(85893),a=t(9913);t(49925);var r=t(34300),n=t(50838),i=t(68239),u=t(46901),c=t(22430),o=t(58703),d=t(15861),x=t(83321),h=t(86886),m=t(94054),p=t(98271),Z=t(4178),j=t(87357),g=t(50480),v=t(85071),f=t(96471),b=t(25675),C=t.n(b),S=t(67294),w=t(23736),y=t(99061);function _(){let{user:e}=(0,n.Eu)(),{fetchProductData:l}=(0,S.useContext)(y.H),[t,b]=(0,S.useState)(""),[_,z]=(0,S.useState)([{size:"",amount:"",price:"",cost:""}]),[k,q]=(0,S.useState)(""),[W,E]=(0,S.useState)(!1),[P,N]=(0,S.useState)(""),[R,A]=(0,S.useState)(""),[U,B]=(0,S.useState)(""),[D,J]=(0,S.useState)(""),[T,F]=(0,S.useState)(""),[I,H]=(0,S.useState)(""),[O,X]=(0,S.useState)(null),$=(0,i.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}}}),G=()=>{window.history.back()};(0,S.useEffect)(()=>{console.log(_)},[_]);let L=(e,l,t)=>{let s=[..._];s[l][t]=e.target.value,z(s)},K=e=>{if(_.length>1){let l=[..._];l.splice(e,1),z(l)}else _.length<=1&&(X((0,s.jsx)(u.Z,{severity:"error",onClose:ee,children:"ต้องมีรูปแบบสินค้าอย่างน้อย 1 รูปแบบ"})),Y(!0))},{catalogData:M}=(0,S.useContext)(w.G),Q=async a=>{a.preventDefault();let n={name:P,catalog_id:R,detail:I,flim:U,grade:D,lot:T,area:k,status:W,img:t,productSizes:_,user_id:e.uid},i=await (0,r.ZP)("products",n);i?(X((0,s.jsx)(u.Z,{severity:"success",onClose:ee,children:"เพิ่มข้อมูลสำเร็จ"})),Y(!0),l(),setTimeout(()=>{G()},500)):(X((0,s.jsx)(u.Z,{severity:"error",onClose:ee,children:"ผิดพลาด! ไม่สามารถเพิ่มข้อมูลได้"})),Y(!0),l())},[V,Y]=(0,S.useState)(!1),ee=(e,l)=>{"clickaway"!==l&&Y(!1)};return(0,s.jsx)(a.Z,{children:(0,s.jsxs)(c.Z,{theme:$,children:[(0,s.jsx)(o.Z,{open:V,autoHideDuration:6e3,onClose:ee,children:O}),(0,s.jsx)(d.Z,{sx:{fontSize:"2rem",fontWeight:"600",mt:4},children:"เพิ่มสินค้า"}),(0,s.jsxs)(x.Z,{sx:{color:"#018294",bgcolor:"white",fontWeight:"bold",borderRadius:"50px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},onClick:G,children:[(0,s.jsx)(f.Z,{}),(0,s.jsx)(d.Z,{children:" ย้อนกลับ"})]}),(0,s.jsx)(h.ZP,{container:!0,spacing:0,sx:{mt:3,mb:5,backgroundColor:"#fff",p:2,borderRadius:"10px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},children:(0,s.jsx)(h.ZP,{item:!0,xs:12,sm:7,children:(0,s.jsxs)("form",{onSubmit:Q,className:"form",children:[(0,s.jsxs)(m.Z,{fullWidth:!0,children:[(0,s.jsx)(d.Z,{children:"แคตตาล็อก:"}),(0,s.jsxs)(p.Z,{value:R,onChange:e=>A(e.target.value),size:"small",select:!0,label:"เลือกแคตตาล็อก",required:!0,children:[(0,s.jsx)(Z.Z,{value:"",children:"กรุณาเลือกแคตตาล็อก"}),M&&M.map(e=>(0,s.jsx)(Z.Z,{value:e.id,children:e.name},e.id))]}),(0,s.jsx)(d.Z,{sx:{mt:1},children:"ข้อมูลสินค้า:"}),(0,s.jsx)(p.Z,{variant:"outlined",value:P,label:"ชื่อสินค้า",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>N(e.target.value)}),(0,s.jsxs)(p.Z,{value:k,onChange:e=>q(e.target.value),size:"small",select:!0,label:"พื้นที่ใช้งาน",sx:{mt:1,mb:1},required:!0,children:[(0,s.jsx)(Z.Z,{value:"สีทาภายนอก",children:"สีทาภายนอก"}),(0,s.jsx)(Z.Z,{value:"สีทาภายใน",children:"สีทาภายใน"}),(0,s.jsx)(Z.Z,{value:"สีน้ำมัน",children:"สีน้ำมัน"}),(0,s.jsx)(Z.Z,{value:"สีย้อมไม้",children:"สีย้อมไม้"})]}),(0,s.jsxs)(p.Z,{value:U,onChange:e=>B(e.target.value),size:"small",select:!0,label:"ฟิล์ม",sx:{mt:1,mb:1},required:!0,children:[(0,s.jsx)(Z.Z,{value:"ฟิล์มสีชนิดเงา",children:"ฟิล์มสีชนิดเงา"}),(0,s.jsx)(Z.Z,{value:"ฟิล์มสีชนิดกึ่งเงา",children:"ฟิล์มสีชนิดกึ่งเงา"}),(0,s.jsxs)(Z.Z,{value:"ฟิล์มสีชนิดเนียน",children:["ฟิล์มสีชนิดเนียน"," "]}),(0,s.jsx)(Z.Z,{value:"ฟิล์มสีชนิดด้าน",children:"ฟิล์มสีชนิดด้าน"})]}),(0,s.jsxs)(p.Z,{value:D,onChange:e=>J(e.target.value),size:"small",select:!0,label:"เกรด",sx:{mt:1,mb:1},required:!0,children:[(0,s.jsx)(Z.Z,{value:"เกรดอัลตร้าพรีเมี่ยม อายุการใช้งาน 15 ปี",children:"เกรดอัลตร้าพรีเมี่ยม อายุการใช้งาน 15 ปี"}),(0,s.jsx)(Z.Z,{value:"เกรดพรีเมี่ยม อายุการใช้งาน 10 ปี",children:"เกรดพรีเมี่ยม อายุการใช้งาน 10 ปี"}),(0,s.jsx)(Z.Z,{value:"เกรดมาตรฐานบน 5-7 ปี",children:"เกรดมาตรฐานบน 5-7 ปี"}),(0,s.jsx)(Z.Z,{value:"เกรดมาตรฐาน 3-5 ปี",children:"เกรดมาตรฐาน 3-5 ปี"}),(0,s.jsx)(Z.Z,{value:"เกรดประหยัด 1-3 ปี",children:"เกรดประหยัด 1-3 ปี"})]}),(0,s.jsx)(p.Z,{value:I,onChange:e=>H(e.target.value),variant:"outlined",label:"รายละเอียดสินค้า",fullWidth:!0,required:!0,rows:4,multiline:!0,size:"small",sx:{mt:1,mb:1}}),(0,s.jsx)(d.Z,{children:" รูปแบบสินค้า: "}),_.map((e,l)=>(0,s.jsxs)(j.Z,{sx:{borderRadius:"10px",mb:3,p:2,boxShadow:"rgba(6, 24, 44, 0.4) 0px 0px 0px 2px, rgba(6, 24, 44, 0.65) 0px 4px 6px -1px, rgba(255, 255, 255, 0.08) 0px 1px 0px inset"},children:[(0,s.jsxs)(d.Z,{children:[" รูปแบบที่:",l+1," "]}),(0,s.jsxs)(p.Z,{value:e.size,onChange:e=>L(e,l,"size"),size:"small",select:!0,fullWidth:!0,label:"ขนาด",sx:{mt:1,mb:1},required:!0,children:[(0,s.jsx)(Z.Z,{value:"",children:"กรุณาเลือกขนาดบรรจุ"}),(0,s.jsx)(Z.Z,{value:"1/4 แกลลอน",children:"1/4 แกลลอน"}),(0,s.jsx)(Z.Z,{value:"1 แกลลอน",children:"1 แกลลอน"}),(0,s.jsx)(Z.Z,{value:"2.5 แกลลอน",children:"2.5 แกลลอน"}),(0,s.jsx)(Z.Z,{value:"5 แกลลอน",children:"5 แกลลอน"})]}),(0,s.jsx)(p.Z,{value:e.price,variant:"outlined",label:"ราคาขาย",onChange:e=>{let t=e.target.value;(/^\d*$/.test(t)||""===t)&&(""===t||parseInt(t)>=0&&"0"!==t[0])&&L(e,l,"price")},fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1}}),(0,s.jsx)(p.Z,{value:e.cost,onChange:e=>{let t=e.target.value;(/^\d*$/.test(t)||""===t)&&(""===t||parseInt(t)>=0&&"0"!==t[0])&&L(e,l,"cost")},variant:"outlined",label:"ราคาซื้อ",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1}}),(0,s.jsx)(x.Z,{variant:"contained",color:"error",fullWidth:!0,onClick:()=>K(l),children:"ลบ"})]},l)),(0,s.jsx)(x.Z,{variant:"contained",fullWidth:!0,sx:{mr:2,mb:2,mt:2,width:"200px"},onClick:()=>{z([..._,{size:"",quantity:"",price:"",cost:""}])},children:"เพิ่มรูปแบบสินค้า"}),(0,s.jsxs)(j.Z,{sx:{textAlign:"left"},children:[(0,s.jsx)(d.Z,{sx:{mb:1},children:"รูปภาพสินค้า:"}),(0,s.jsx)(j.Z,{children:t&&(0,s.jsx)(C(),{src:t,alt:"Uploaded Image",priority:!0,height:"150",width:"150",style:{border:"1px solid rgba(0, 0, 0, 0.50)"}})}),(0,s.jsxs)("label",{htmlFor:"upload-image",children:[(0,s.jsx)(x.Z,{variant:"contained",component:"span",children:"เพิ่มรูปภาพสินค้า"}),(0,s.jsx)("input",{id:"upload-image",hidden:!0,accept:"image/*",type:"file",onChange:e=>{let l=e.target.files[0];if(!l){console.error("No file selected."),b("");return}let t=new FileReader;t.onloadend=()=>{b(t.result)},t.readAsDataURL(l)}})]})]}),(0,s.jsx)(j.Z,{children:(0,s.jsx)(g.Z,{sx:{m:0},control:(0,s.jsx)(v.Z,{checked:W,onChange:e=>{E(e.target.checked)}}),label:"เปิดให้สั่งซื้อ:",labelPlacement:"start"})})]}),(0,s.jsx)(x.Z,{variant:"contained",color:"success",sx:{mr:2,mb:2,mt:2},type:"submit",children:"เพิ่มสินค้า"})]})})})]})})}}},function(e){e.O(0,[2607,7609,5675,6298,6185,1283,3717,3914,8360,8271,4792,187,9913,9774,2888,179],function(){return e(e.s=66312)}),_N_E=e.O()}]);