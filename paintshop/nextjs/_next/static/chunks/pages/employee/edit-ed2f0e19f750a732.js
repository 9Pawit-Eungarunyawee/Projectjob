(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5095],{24148:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/employee/edit",function(){return a(45956)}])},53233:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var l=a(11802),n=a(36100);let r=(0,n.ad)(l.Z);async function i(e,t,a){let l=null,i=null;if(a.catalog_id){let e=(0,n.JU)(r,"catalog",a.catalog_id);a.catalog_id=e}try{l=await (0,n.pl)((0,n.JU)(r,e,t),a,{merge:!0}),console.log("แก้ไขสำเร็จ",l)}catch(e){console.error("เกิดข้อผิดพลาดในการแก้ไขข้อมูล:",i=e)}return{result:l,error:i}}},45956:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var l=a(85893),n=a(9913),r=a(53233),i=a(49925),s=a(46901),o=a(87357),u=a(15861),d=a(86886),c=a(83321),m=a(98271),h=a(94054),p=a(4178),x=a(25675),f=a.n(x),g=a(11163),v=a(67294);function b(){var e,t,a;let x=(0,g.useRouter)(),b=JSON.parse(x.query.employeeData),[j,_]=(0,v.useState)("/../public/default-profile.jpg"),[Z,S]=(0,v.useState)(""),[y,w]=(0,v.useState)(""),[C,E]=(0,v.useState)(""),[z,k]=(0,v.useState)(""),[N,W]=(0,v.useState)(""),[P,q]=(0,v.useState)(""),[U,D]=(0,v.useState)(""),[R,J]=(0,v.useState)(""),[O,T]=(0,v.useState)([]),[A,F]=(0,v.useState)(null),X=async()=>{let{result:e,error:t}=await (0,i.ZP)("users",b);if(t)console.error("Error fetching document:",t);else if(e){let t=e.data();S(t.name),W(t.email),w(t.tel),E(t.address),_(t.profileUrl),q(t.province),D(t.amphure),J(t.tambon),t.salary&&k(t.salary)}};(0,v.useEffect)(()=>{X(),fetch("https://raw.githubusercontent.com/kongvut/thai-province-data/master/api_province_with_amphure_tambon.json",{method:"GET",redirect:"follow"}).then(e=>e.json()).then(e=>{e.sort((e,t)=>e.name_th.localeCompare(t.name_th)),e.forEach(e=>{e.amphure&&(e.amphure.sort((e,t)=>e.name_th.localeCompare(t.name_th)),e.amphure.forEach(e=>{e.tambon&&e.tambon.sort((e,t)=>e.name_th.localeCompare(t.name_th))}))}),T(e)}).catch(e=>console.log("error",e))},[]);let G=async e=>{e.preventDefault();let t=await (0,r.Z)("users",b,{email:N,name:Z,address:C,province:P,amphure:U,tambon:R,tel:y,profileUrl:j,salary:z});t?F((0,l.jsx)(s.Z,{severity:"success",children:"แก้ไข้ข้อมูลสำเร็จ"})):F((0,l.jsx)(s.Z,{severity:"error",children:"ผิดพลาด! ไม่สามารถแก้ไข้ข้อมูลได้"}))};return(0,l.jsx)(n.Z,{children:(0,l.jsxs)(o.Z,{children:[(0,l.jsx)(u.Z,{sx:{fontSize:"2vw",fontWeight:"600",mt:5},children:"แก้ไขข้อมูลพนักงาน"}),A,(0,l.jsx)("form",{onSubmit:G,className:"form",children:(0,l.jsx)(o.Z,{sx:{m:2},children:(0,l.jsxs)(d.ZP,{container:!0,spacing:1,sx:{backgroundColor:"#fff",p:1,borderRadius:"10px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},children:[(0,l.jsx)(d.ZP,{item:!0,xs:12,sm:12,children:(0,l.jsxs)(o.Z,{sx:{textAlign:"center"},children:[(0,l.jsx)(o.Z,{children:j&&(0,l.jsx)(f(),{src:j,alt:"Uploaded Image",priority:!0,height:"150",width:"150",style:{borderRadius:"100px",border:"1px solid rgba(0, 0, 0, 0.50)"}})}),(0,l.jsxs)("label",{htmlFor:"upload-image",children:[(0,l.jsx)(c.Z,{variant:"contained",component:"span",children:"แก้ไขรูปโปรไฟล์"}),(0,l.jsx)("input",{id:"upload-image",hidden:!0,accept:"image/*",type:"file",onChange:e=>{let t=e.target.files[0];if(!t){console.error("No file selected."),_("/../public/default-profile.jpg");return}let a=new FileReader;a.onloadend=()=>{_(a.result)},a.readAsDataURL(t)}})]})]})}),(0,l.jsxs)(d.ZP,{item:!0,xs:12,sm:6,children:[(0,l.jsx)(m.Z,{variant:"outlined",value:String(Z),label:"ชื่อ",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>S(e.target.value)}),(0,l.jsx)(m.Z,{variant:"outlined",value:String(N),label:"อีเมล",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>W(e.target.value)}),(0,l.jsx)(m.Z,{variant:"outlined",label:"เบอร์ติดต่อ",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>w(e.target.value),value:String(y)}),(0,l.jsx)(m.Z,{variant:"outlined",label:"ค่าจ้าง",onKeyDown:e=>{("-"===e.key||"e"===e.key)&&e.preventDefault()},fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>k(e.target.value),value:String(z)})]}),(0,l.jsxs)(d.ZP,{item:!0,xs:12,sm:6,children:[(0,l.jsx)(m.Z,{variant:"outlined",label:"บ้านเลขที่",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>E(e.target.value),value:String(C)}),(0,l.jsxs)(h.Z,{fullWidth:!0,children:[(0,l.jsxs)(m.Z,{size:"small",label:"จังหวัด",select:!0,sx:{mt:1,mb:1},value:String(P),onChange:e=>{q(e.target.value),D(""),J("")},children:[(0,l.jsx)(p.Z,{value:"",children:"กรุณาเลือกจังหวัด"}),O.map(e=>(0,l.jsx)(p.Z,{value:String(e.name_th),children:e.name_th},e.id))]}),(0,l.jsxs)(m.Z,{size:"small",label:"อำเภอ",select:!0,sx:{mt:1,mb:1},value:String(U),onChange:e=>{D(e.target.value),J("")},children:[(0,l.jsx)(p.Z,{value:"",children:"กรุณาเลือกอำเภอ"}),P&&(null===(e=O.find(e=>e.name_th===P))||void 0===e?void 0:e.amphure.map(e=>(0,l.jsx)(p.Z,{value:String(e.name_th),children:e.name_th},e.id)))]}),(0,l.jsxs)(m.Z,{size:"small",label:"ตำบล",select:!0,value:String(R),onChange:e=>{J(e.target.value)},sx:{mt:1,mb:1},children:[(0,l.jsx)(p.Z,{value:"",children:"กรุณาเลือกตำบล"}),U&&(null===(a=O.find(e=>e.name_th===P))||void 0===a?void 0:null===(t=a.amphure.find(e=>e.name_th===U))||void 0===t?void 0:t.tambon.map(e=>(0,l.jsx)(p.Z,{value:String(e.name_th),children:e.name_th},e.id)))]})]})]}),(0,l.jsx)(c.Z,{variant:"contained",sx:{p:2,mb:4},fullWidth:!0,type:"submit",children:"บันทึก"})]})})})]})})}}},function(e){e.O(0,[2607,7609,5675,6298,6185,1283,3717,3914,8360,8271,5897,9913,9774,2888,179],function(){return e(e.s=24148)}),_N_E=e.O()}]);