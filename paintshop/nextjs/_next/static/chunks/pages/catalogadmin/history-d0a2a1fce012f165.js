(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6781],{61948:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/catalogadmin/history",function(){return n(11524)}])},94521:function(e,t,n){"use strict";n.d(t,{Y:function(){return a},_:function(){return o}});var l=n(11802),r=n(36100),i=n(49925);let c=(0,r.ad)(l.Z);async function o(e,t){let n=null,l=null;try{let l=await (0,i.ZP)("users",t.user_id);if(l.result&&l.result.exists){let i=l.result.data().name,o={delete:{deleteAt:(0,r.Bt)(),deleteBy:i}};n=await (0,r.pl)((0,r.JU)(c,e,t.id),o,{merge:!0}),console.log("Soft delete สำเร็จ",n)}else console.log("หาข้อมูล user ใน soft del ไม่เจอ")}catch(e){console.error("เกิดข้อผิดพลาดในการ soft delete:",l=e)}return{result:n,error:l}}async function a(e,t){let n=null,l=null;try{n=await (0,r.pl)((0,r.JU)(c,e,t),{delete:null},{merge:!0}),console.log("restoreCatalog สำเร็จ",n)}catch(e){console.error("เกิดข้อผิดพลาดในการ restoreCatalog:",l=e)}return{result:n,error:l}}},11524:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var l=n(85893),r=n(9913),i=n(11463),c=n(16829),o=n(98102),a=n(89755),s=n(53816),d=n(68239),u=n(46901),h=n(58703),x=n(87357),g=n(15861),m=n(83321),f=n(72882),j=n(90629),Z=n(7906),p=n(53184),y=n(295),w=n(96471),_=n(67294);n(23736);var b=n(25675),C=n.n(b),k=n(49925),S=n(94521);function A(){let e=(0,c.Z)(o.Z)(e=>{let{theme:t}=e;return{["&.".concat(a.Z.head)]:{backgroundColor:"#018294",color:t.palette.common.white},["&.".concat(a.Z.body)]:{fontSize:14}}}),t=(0,c.Z)(s.Z)(e=>{let{theme:t}=e;return{"&:nth-of-type(odd)":{backgroundColor:t.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}}),n=(0,d.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}}}),[b,A]=(0,_.useState)(null),[N,E]=(0,_.useState)(!1),v=(e,t)=>{"clickaway"!==t&&E(!1)},[B,P]=(0,_.useState)([]);(0,_.useEffect)(()=>{T()},[]);let T=async()=>{let{result:e,error:t}=await (0,k._N)("catalog");if(t)console.error("Error fetching document:",t);else if(e){let t=e.docs.filter(e=>e.data().delete).map(e=>({id:e.id,name:e.data().name,img:e.data().img,deleteAt:e.data().delete.deleteAt,deleteBy:e.data().delete.deleteBy}));P(t)}},W=B.map((e,t)=>{var n;let l=e.deleteAt?e.deleteAt.toDate().toLocaleString("th-TH",{dateStyle:"full",timeStyle:"medium"}):"";return n=e.id,{No:t+1,id:n,img:e.img,c_name:e.name,deleteAt:l,deleteBy:e.deleteBy}}),z=async e=>{let t=await (0,S.Y)("catalog",e);T(),t?(A((0,l.jsx)(u.Z,{severity:"success",onClose:v,children:"กู้คืนข้อมูลสำเร็จ"})),E(!0)):(A((0,l.jsx)(u.Z,{severity:"error",onClose:v,children:"ผิดพลาด! ไม่สามารถกู้คืนข้อมูลได้"})),E(!0))};return(0,l.jsx)(r.Z,{children:(0,l.jsxs)(i.a,{theme:n,children:[(0,l.jsx)(h.Z,{open:N,autoHideDuration:6e3,onClose:v,children:b}),(0,l.jsx)(x.Z,{children:(0,l.jsxs)(x.Z,{sx:{height:"100%",width:"100%",mt:5},children:[(0,l.jsx)(g.Z,{sx:{fontSize:"2rem",fontWeight:"600"},children:"ประวัติการลบแคตาล็อก"}),(0,l.jsxs)(m.Z,{sx:{color:"#018294",bgcolor:"white",fontWeight:"bold",borderRadius:"50px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)",mb:2},onClick:()=>{window.history.back()},children:[(0,l.jsx)(w.Z,{}),(0,l.jsx)(g.Z,{children:" ย้อนกลับ"})]}),(0,l.jsx)(f.Z,{component:j.Z,sx:{borderRadius:"25px"},children:(0,l.jsxs)(Z.Z,{sx:{minWidth:700},children:[(0,l.jsx)(p.Z,{children:(0,l.jsxs)(s.Z,{children:[(0,l.jsx)(e,{align:"center",children:"No."}),(0,l.jsx)(e,{align:"center",children:"รูปภาพ"}),(0,l.jsx)(e,{align:"center",children:"ชื่อแคตตาล็อก"}),(0,l.jsx)(e,{align:"center",children:"วันที่ลบ"}),(0,l.jsx)(e,{align:"center",children:"ผู้ลบ"}),(0,l.jsx)(e,{align:"center"})]})}),(0,l.jsx)(y.Z,{children:W.map(n=>(0,l.jsxs)(t,{children:[(0,l.jsx)(e,{align:"center",children:n.No}),(0,l.jsx)(e,{align:"center",children:(0,l.jsx)(C(),{src:n.img,alt:"Product Image",priority:!0,height:"75",width:"75"})}),(0,l.jsx)(e,{align:"center",children:n.c_name}),(0,l.jsx)(e,{align:"center",children:n.deleteAt}),(0,l.jsx)(e,{align:"center",children:n.deleteBy}),(0,l.jsx)(e,{align:"center",children:(0,l.jsx)(m.Z,{color:"primary",onClick:()=>z(n.id),children:"กู้คืน"})})]},n.id))})]})})]})})]})})}}},function(e){e.O(0,[2607,7609,5675,6185,1283,3717,3914,4792,9254,4254,9913,9774,2888,179],function(){return e(e.s=61948)}),_N_E=e.O()}]);