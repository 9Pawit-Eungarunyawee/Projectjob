(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[640],{39945:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/catalogadmin/editcatalog",function(){return t(73883)}])},73883:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return E}});var s=t(85893),a=t(98010);t(94521);var i=t(84178),l=t(11802),o=t(36100);let n=(0,o.ad)(l.Z);async function c(e,r,t){let s=null,a=null;try{s=await (0,o.pl)((0,o.JU)(n,e,r),t,{merge:!0}),console.log("แก้ไขสำเร็จ",s)}catch(e){console.error("เกิดข้อผิดพลาดในการแก้ไขข้อมูล:",a=e)}return{result:s,error:a}}var d=t(49925),x=t(68239),h=t(46901),m=t(22430),u=t(58703),p=t(87357),g=t(15861),f=t(86886),j=t(10945),Z=t(83321),b=t(34386),v=t(23279),w=t.n(v),y=t(25675),C=t.n(y),S=t(11163),_=t(67294);function E(){let e=(0,x.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}}}),r=(0,S.useRouter)(),t=JSON.parse(r.query.catalog_id),[l,o]=(0,_.useState)(""),[n,v]=(0,_.useState)(""),[y,E]=(0,_.useState)(""),[R,N]=(0,_.useState)(""),[k,F]=(0,_.useState)(""),[P,z]=(0,_.useState)(""),[A,D]=(0,_.useState)(!1),[W,q]=(0,_.useState)(null),[B,G]=(0,_.useState)("#fff"),[O,T]=(0,_.useState)([]),[U,J]=(0,_.useState)([]),[X,H]=(0,_.useState)("");(0,_.useEffect)(()=>{I(),L(),M()},[]);let I=async()=>{let{result:e,error:r}=await (0,d._N)("colorshade");if(r)console.error("Error fetching document:",r);else if(e){let r=e.docs.map(e=>({id:e.id,name:e.data().name,code:e.data().code}));T(r),G(r[0].code)}},L=async()=>{let{result:e,error:r}=await (0,d.ZP)("catalog",t);if(r)console.error("Error fetching document:",r);else if(e){let r=e.data();o(r.name),z(r.img),v(r.detail)}},M=async()=>{let{result:e,error:r}=await (0,d.EC)("colors",t);if(r)console.error("Error fetching colors:",r);else if(e){let r=e.docs.map(e=>({id:e.id,name:e.data().name,code:e.data().code,codename:e.data().code_name,catalog_id:e.data().catalog_id.id}));J(r)}},$=(e,r)=>{"clickaway"!==r&&D(!1)},K=w()(e=>{N(e)},500),Q=async e=>{e.preventDefault();let r=await c("catalog",t,{name:l,img:P});r?(q((0,s.jsx)(h.Z,{severity:"success",onClose:$,children:"เพิ่มข้อมูลสำเร็จ"})),D(!0)):(q((0,s.jsx)(h.Z,{severity:"error",onClose:$,children:"ผิดพลาด! ไม่สามารถเพิ่มข้อมูลได้"})),D(!0))},V=(e,r)=>{H(e),G(r),console.log(X)},Y=async e=>{if(e.preventDefault(),console.log("colordata:",l,R,k,t,X),""===X){q((0,s.jsx)(h.Z,{severity:"error",onClose:$,children:"กรุณาเลือกเฉดสีก่อนเพิ่มสี"})),D(!0);return}let r=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(R);if(!r){q((0,s.jsx)(h.Z,{severity:"error",onClose:$,children:"กรุณากรอกโค้ดสีให้ถูกต้อง"})),D(!0);return}if(""!==y&&""!==R&&""!==k&&t&&X){let e=await (0,i.Z)("colors",{catalog_id:t,code:R,codename:k,colorshade_id:X,name:y});N(""),F(""),E(""),e?(q((0,s.jsx)(h.Z,{severity:"success",onClose:$,children:"เพิ่มสีสำเร็จ"})),D(!0),M()):(q((0,s.jsx)(h.Z,{severity:"error",onClose:$,children:"ผิดพลาด! ไม่สามารถเพิ่มสีได้"})),D(!0))}};return(0,s.jsx)(a.Z,{children:(0,s.jsxs)(m.Z,{theme:e,children:[(0,s.jsx)(u.Z,{open:A,autoHideDuration:6e3,onClose:$,children:W}),(0,s.jsxs)(p.Z,{sx:{height:"100%",width:"100%",mt:5},children:[(0,s.jsx)(g.Z,{sx:{fontSize:"2rem",fontWeight:"600"},children:"แก้ไขแคตตาล็อก"}),(0,s.jsx)("form",{onSubmit:Q,className:"form",children:(0,s.jsxs)(f.ZP,{container:!0,spacing:0,sx:{mt:3,mb:5,backgroundColor:"#fff",p:2,borderRadius:"10px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},children:[(0,s.jsxs)(f.ZP,{item:!0,xs:12,sm:7,children:[(0,s.jsx)(g.Z,{sx:{mt:1},children:"ชื่อแคตตาล็อก:"}),(0,s.jsx)(j.Z,{variant:"outlined",value:l,label:"ชื่อแคตตาล็อก",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>o(e.target.value)}),(0,s.jsx)(g.Z,{sx:{mt:1},children:"รายละเอียดแค็ตตาล็อก:"}),(0,s.jsx)(j.Z,{value:n,onChange:e=>v(e.target.value),variant:"outlined",label:"รายละเอียดแค็ตตาล็อก",fullWidth:!0,required:!0,rows:4,multiline:!0,size:"small",sx:{mt:1,mb:1}}),(0,s.jsxs)(p.Z,{sx:{textAlign:"left"},children:[(0,s.jsx)(g.Z,{sx:{mb:1},children:"รูปแค็ตตาล็อก:"}),(0,s.jsx)(p.Z,{children:P&&(0,s.jsx)(C(),{src:P,alt:"Uploaded Image",priority:!0,height:"200",width:"260",style:{border:"1px solid rgba(0, 0, 0, 0.50)",objectFit:"cover"}})}),(0,s.jsxs)("label",{htmlFor:"upload-image",children:[(0,s.jsx)(Z.Z,{variant:"contained",component:"span",children:"เปลี่ยนรูปภาพแคตตาล็อก"}),(0,s.jsx)("input",{id:"upload-image",hidden:!0,accept:"image/*",type:"file",onChange:e=>{let r=e.target.files[0];if(!r){console.error("No file selected."),z("");return}let t=new FileReader;t.onloadend=()=>{z(t.result)},t.readAsDataURL(r)}})]})]}),(0,s.jsx)(g.Z,{sx:{mt:1},children:"เพิ่มสี:"}),(0,s.jsxs)(p.Z,{sx:{ml:2},children:[(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(g.Z,{sx:{mt:1},children:"เฉดสี:"}),(0,s.jsx)(p.Z,{sx:{width:"10rem",height:"3rem",bgcolor:B,transition:"0.2s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.20)",mb:2,borderRadius:"5px"}}),(0,s.jsx)(p.Z,{sx:{display:"flex"},children:O&&O.map(e=>(0,s.jsx)(p.Z,{onClick:()=>V(e.id,e.code),sx:{bgcolor:e.code,width:"2rem",height:"3rem",transform:e.id==X?"scale(1.2)":"scale(1)",cursor:"pointer",borderRadius:"100px",transition:"0.2s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)",m:1,":hover":{transform:"scale(1.2)"}}},e.id))})]}),(0,s.jsx)("hr",{}),(0,s.jsx)(g.Z,{sx:{mt:1},children:"สี:"}),(0,s.jsxs)(p.Z,{sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},children:[(0,s.jsx)(p.Z,{sx:{width:"10rem",height:"3rem",bgcolor:R,transition:"0.2s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.20)",mb:2,borderRadius:"5px"}}),(0,s.jsx)(j.Z,{variant:"outlined",value:R,label:"โค้ดสี",size:"small",type:"color",sx:{mt:1,mb:1},onChange:e=>{let r=e.target.value;K(r)},placeholder:"#RRGGBB หรือ #RGB"}),(0,s.jsx)(j.Z,{variant:"outlined",value:y,label:"ชื่อสี",size:"small",sx:{mt:1,mb:1},onChange:e=>E(e.target.value)}),(0,s.jsx)(j.Z,{variant:"outlined",value:k,label:"โค้ดเนม",size:"small",sx:{mt:1,mb:1},onChange:e=>F(e.target.value)}),(0,s.jsx)(Z.Z,{variant:"contained",sx:{mt:1,mb:1,width:"34ch",m:1},onClick:Y,children:"เพิ่ม"})]})]})]}),(0,s.jsxs)(f.ZP,{item:!0,xs:12,sm:5,children:[(0,s.jsx)(g.Z,{sx:{mt:1},children:"สีที่มีในแคตตาล็อก:"}),(0,s.jsx)(p.Z,{sx:{display:"flex",flexWrap:"wrap"},children:U&&U.map((e,r)=>(0,s.jsx)(b.Z,{arrow:!0,title:(0,s.jsxs)(_.Fragment,{children:[(0,s.jsxs)(g.Z,{color:"inherit",children:["โค้ดสี: ",e.code]}),(0,s.jsxs)(g.Z,{color:"inherit",children:["ชื่อสี: ",e.name]}),(0,s.jsxs)(g.Z,{color:"inherit",children:["โค้ดเนม: ",e.codename]})]}),children:(0,s.jsx)(p.Z,{sx:{bgcolor:e.code,width:"2rem",height:"3rem",cursor:"pointer",borderRadius:"100px",transition:"0.1s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)",m:1,":hover":{transform:"scale(1.2)"}}})},r))})]}),(0,s.jsx)(f.ZP,{item:!0,xs:12,children:(0,s.jsx)(Z.Z,{variant:"contained",color:"success",sx:{mr:2,mb:2,mt:2},type:"submit",children:"แก้ไขแค็ตตาล็อก"})})]})})]})]})})}}},function(e){e.O(0,[2607,9078,7393,6298,6886,505,3717,3914,945,4792,6078,1667,8010,6679,9774,2888,179],function(){return e(e.s=39945)}),_N_E=e.O()}]);