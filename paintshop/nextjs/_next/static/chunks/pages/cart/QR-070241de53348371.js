(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3871],{35152:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart/QR",function(){return r(1548)}])},59741:function(e,t){"use strict";t.Z={src:"/_next/static/media/Logo.6eb3998a.png",height:500,width:500,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAtklEQVR42mMAgX+rUxgZkMDXPX5McM7/ZRFgyT/7/KW+tlux/GdgEGdAB/8PxLP+3x449/++TK33u4ue/p8QNgls8mk+iEm/z2/T+rFjwf+Py5enxpx/OuHeior//6Vc9RAmeBaIP5pX8L9s74UNDJvutV+ZVfb/v020CVjy09ZcZrCiCf6ND5aX/b8KlPxXnDwXJPbgLAMjqlsY3DX/G0cbIPgTGBGSu/TgXnt8jIHxP0M/WBIArFFPt28L8gwAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},17576:function(e,t,r){"use strict";r.d(t,{Z:function(){return X}});var n=r(85893),l=r(67294),s=r(66720),o=r(65582),i=r(68239),a=r(22430),c=r(2734),u=r(98396),d=r(42293),h=r(10155),x=r(83321),p=r(93946),g=r(69661),f=r(35294),m=r(4178),j=r(15861),Z=r(77533),w=r(78462),y=r(76113),A=r(48885),P=r(59334),b=r(326);let k=["หน้าแรก","ผลิตภัณฑ์","ออกแบบ"];var E=()=>{let[e,t]=l.useState(!1);return(0,n.jsxs)(l.Fragment,{children:[(0,n.jsx)(Z.ZP,{anchor:"left",open:e,onClose:()=>t(!1),children:(0,n.jsx)(w.Z,{children:k.map((e,t)=>(0,n.jsx)(y.Z,{children:(0,n.jsx)(A.Z,{children:(0,n.jsx)(P.Z,{children:e})})},t))})}),(0,n.jsx)(p.Z,{sx:{color:"black"},onClick:()=>t(!e),children:(0,n.jsx)(b.Z,{color:"white"})})]})},v=r(87357),C=r(59741),F=r(25675),S=r.n(F),_=r(41664),I=r.n(_),L=r(42761),J=r(46624),U=r(9669),N=r(50838),R=r(39332),D=r(49925);let O=["โปรไฟล์","ออกจากระบบ"];function T(){let[e,t]=l.useState(null),{role:r,user:s}=(0,N.Eu)();"admin"==r?(O=["โปรไฟล์","แดชบอร์ด","ออกจากระบบ"],console.log(s)):"employee"==r?(O=["โปรไฟล์","แดชบอร์ด","ออกจากระบบ"],console.log(s)):(O=["โปรไฟล์","ออกจากระบบ"],console.log(s));let[o,Z]=l.useState(""),[w,y]=l.useState(null),[A,P]=l.useState(null);l.useEffect(()=>{b()},[]);let b=async()=>{let e=s.uid,{result:r,error:n}=await (0,D.PR)("users",e);if(n)console.error("Error fetching collection:",n);else{let e=r.docs.map(e=>({id:e.id,name:e.data().name,email:e.data().email,tel:e.data().tel,img:e.data().profileUrl}));t(e)}},k=(0,U.v0)(),F=async()=>{try{await (0,U.w7)(k),console.log("User signed out")}catch(e){console.error("An error occurred while signing out:",e)}},_=(0,R.useRouter)(),T=e=>{"ออกจากระบบ"==e?F():"โปรไฟล์"==e?_.push("/account/profile"):"แดชบอร์ด"==e&&("admin"==r?_.push("/dashboard"):_.push("/product"))};console.log("ทดสอบpath",_.pathname),l.useEffect(()=>{Z(_.pathname)},[_.pathname]);let X=(0,c.Z)();console.log(X);let B=(0,u.Z)(X.breakpoints.down("md"));console.log(B);let M=(0,i.Z)({typography:{fontFamily:"Prompt",fontSize:18},palette:{primary:{main:"#ffffff"}}});console.log("Current Path:",o);let W={Box:{transition:"0.1s","&:hover":{transition:"0.1s",color:"#018294"}},activeLink:{fontWeight:"bold",color:"#018294"}};return(0,n.jsx)(a.Z,{theme:M,children:(0,n.jsx)(d.Z,{position:"static",sx:{background:"white"},children:(0,n.jsxs)(h.Z,{children:[(0,n.jsx)(S(),{src:C.Z,alt:"logo",style:{objectFit:"cover",width:"4vw",height:"100%"},sx:{display:{xs:"flex",md:"none"},mr:1}}),B?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(E,{})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I(),{style:{color:"black"},href:"/homepage",passHref:!0,onClick:e=>Z("/homepage"),children:(0,n.jsx)(v.Z,{sx:"/homepage"===o?W.activeLink:W.Box,children:(0,n.jsx)(x.Z,{color:"inherit",children:"หน้าแรก"})})}),(0,n.jsx)(I(),{style:{color:"black"},href:"/catalog",passHref:!0,onClick:e=>Z("/catalog"),children:(0,n.jsx)(v.Z,{sx:"/catalog"===o?W.activeLink:W.Box,children:(0,n.jsx)(x.Z,{color:"inherit",children:"ผลิตภัณฑ์"})})}),(0,n.jsx)(p.Z,{color:"black",sx:{marginLeft:"auto"},children:(0,n.jsx)(L.Z,{})}),(0,n.jsx)(I(),{href:"/cart",children:(0,n.jsx)(p.Z,{color:"black",children:(0,n.jsx)(J.Z,{})})}),(0,n.jsx)(p.Z,{onClick:e=>{P(e.currentTarget)},sx:{p:0},children:e&&e.map((e,t)=>(0,n.jsx)(v.Z,{children:(0,n.jsx)(g.Z,{src:e.img,alt:"profile",sx:{width:32,height:32,ml:1}})},t))}),(0,n.jsx)(f.Z,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:A,anchorOrigin:{vertical:"top",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!A,onClose:()=>{P(null)},children:O.map(e=>(0,n.jsx)(m.Z,{onClick:()=>T(e),children:(0,n.jsx)(j.Z,{textAlign:"center",children:e})},e))})]})]})})})}function X(e){let{children:t}=e,{user:r,isAdmin:i}=(0,N.Eu)(),a=(0,R.useRouter)();return l.useEffect(()=>{null==r&&a.push("/")},[r]),(0,n.jsxs)(l.Fragment,{children:[(0,n.jsx)(s.ZP,{}),(0,n.jsxs)(o.Z,{maxWidth:"sx",sx:{bgcolor:"#FAF8F1"},style:{padding:"0px"},children:[(0,n.jsx)(T,{}),t]})]})}},49925:function(e,t,r){"use strict";r.d(t,{EC:function(){return a},Eq:function(){return u},KL:function(){return c},PR:function(){return d},ZP:function(){return o},_N:function(){return i},wv:function(){return h}});var n=r(11802),l=r(36100);let s=(0,l.ad)(n.Z);async function o(e,t){let r=(0,l.JU)(s,e,t);try{let e=await (0,l.QT)(r);return{result:e,error:null}}catch(e){return{result:null,error:e}}}let i=async e=>{let t=await (0,l.PL)((0,l.hJ)(s,e));return{result:t,error:null}},a=async(e,t)=>{let r=(0,l.JU)(s,"catalog",t),n=(0,l.IO)((0,l.hJ)(s,e),(0,l.ar)("catalog_id","==",r)),o=await (0,l.PL)(n);return{result:o,error:null}},c=async e=>{let t=[];for(let r of e){let e=await (0,l.QT)((0,l.JU)(s,"products",r));if(e.exists()){let n=e.data(),l={id:r,...n};t.push(l)}}return t},u=async e=>{let t=[];for(let r of e){let e=await (0,l.QT)((0,l.JU)(s,"colors",r));if(e.exists()){let n=e.data(),l={id:r,...n};t.push(l)}}return t},d=async(e,t)=>{let r=(0,l.IO)((0,l.hJ)(s,e),(0,l.ar)("uid","==",String(t))),n=await (0,l.PL)(r);return n.forEach(e=>{console.log(e.id," => ",e.data())}),{result:n,error:null}},h=async(e,t)=>{let r=(0,l.JU)(s,"catalog",t),n=await (0,l.QT)(r);if(!n.exists())return console.error("Catalog document not found"),{result:null,error:"Catalog document not found"};let o=(0,l.IO)((0,l.hJ)(s,e),(0,l.ar)("catalog_id","==",r));try{let e=await (0,l.PL)(o);return e.forEach(e=>{console.log(e.id," => ",e.data())}),{result:e,error:null}}catch(e){return console.error("Error getting products: ",e),{result:null,error:e}}}},1548:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var n=r(85893),l=r(67294),s=r(87357),o=r(17576),i=r(68239),a=r(46901),c=r(22430),u=r(65582),d=r(86886),h=r(15861),x=r(83321),p=r(11163),g=r(84059),f=r(25675),m=r.n(f),j=r(50838),Z=r(11802),w=r(36100);let y=(0,w.ad)(Z.Z);async function A(e,t){let r=null,n=null;console.log("wwwwww",t);let l=new Date,s=t.img?t.img:"";try{let n={product_id:t.product_id,user_id:t.user_id,price:t.price,date:l,img:s,status:t.status};console.log(n),r=await (0,w.ET)((0,w.hJ)(y,e),n),console.log("เพิ่มข้อมูลสำเร็จ",r)}catch(e){console.error("เกิดข้อผิดพลาดในการเพิ่มข้อมูล:",n=e)}return{result:r,error:n}}let P=async e=>{let t=null,r=null;try{await Promise.all(e.map(async e=>{let t=(0,w.JU)(y,"cart",e);await (0,w.oe)(t)})),console.log("ลบข้อมูลสำเร็จ"),t=!0}catch(e){console.error("เกิดข้อผิดพลาดในการลบข้อมูล:",r=e),t=!1}return{result:t,error:r}},b=r(23793);function k(){let e=(0,p.useRouter)(),t=(0,j.Eu)(),r=JSON.parse(e.query.total),f=JSON.parse(e.query.productIDs),Z=JSON.parse(e.query.cartId);console.log("Cart ID:",Z);let[w,y]=l.useState(r),[k,E]=l.useState("0960868037"),[v,C]=l.useState("null"),[F,S]=l.useState(300),[_,I]=l.useState(""),[L,J]=l.useState(null);l.useEffect(()=>{!function(){if(k&&null!==w){let e=b(k,{price:w});C(e)}else console.error("Missing phoneNumber or price")}()},[]),l.useEffect(()=>{let e=setInterval(()=>{S(e=>e-1)},1e3);return()=>clearInterval(e)},[]),l.useEffect(()=>{F<=0&&e.push("/cart")},[F]);let U=Math.floor(F/60),N=F%60,R=(0,i.Z)({palette:{primary:{main:"#FE616A"}}}),D=async e=>{let r=new Date,l={product_id:e,user_id:t.user.uid,price:w,date:r,img:_,status:"disapprove"},s=await P(Z);if(s.result){let e=await A("orders",l);e.result?(J((0,n.jsx)(a.Z,{severity:"success",onClose:X,children:"ชำระเงินเสร็จสิ้น"})),T(!0)):(J((0,n.jsx)(a.Z,{severity:"error",onClose:X,children:"ผิดพลาด! ไม่สามารถชำระเงิน"})),T(!0))}else J((0,n.jsx)(a.Z,{severity:"error",onClose:X,children:"ผิดพลาด! ไม่สามารถลบสินค้าในตะกร้าได้"})),T(!0)},[O,T]=l.useState(!1),X=(e,t)=>{"clickaway"!==t&&T(!1)};return(0,n.jsx)(o.Z,{children:(0,n.jsx)(c.Z,{theme:R,children:(0,n.jsx)(s.Z,{sx:{width:"100%"},children:(0,n.jsx)(u.Z,{maxWidth:!1,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,n.jsxs)(s.Z,{children:[(0,n.jsxs)(d.ZP,{container:!0,spacing:2,direction:"column",alignItems:"center",sx:{mt:2,p:3,pt:2,bgcolor:"#FFF",boxShadow:"0px 4px 4px 0px rgba(0, 0, 0, 0.25)",borderRadius:"25px"},children:[(0,n.jsx)(d.ZP,{children:(0,n.jsx)(m(),{src:"https://upload.wikimedia.org/wikipedia/commons/c/c5/PromptPay-logo.png",alt:"PromptPay Logo",width:250,height:150})}),(0,n.jsx)(d.ZP,{children:(0,n.jsx)(g.ZP,{value:v,size:250})}),(0,n.jsxs)(d.ZP,{textAlign:"center",children:[(0,n.jsxs)(h.Z,{children:["จำนวนเงิน : ฿",w.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")]}),(0,n.jsx)(h.Z,{children:"ระยะเวลาการชำระเงิน:"}),(0,n.jsxs)(h.Z,{children:[U," นาที ",N," วินาที"]})]})]}),(0,n.jsxs)(d.ZP,{textAlign:"center",mt:2,children:[(0,n.jsx)(s.Z,{children:_&&(0,n.jsx)(m(),{src:_,alt:"Uploaded Image",priority:!0,height:"200",width:"260",style:{border:"1px solid rgba(0, 0, 0, 0.50)",objectFit:"cover"}})}),(0,n.jsxs)("label",{htmlFor:"upload-image",children:[(0,n.jsx)(x.Z,{variant:"contained",component:"span",children:"เพิ่มรูปภาพหลักฐาน"}),(0,n.jsx)("input",{id:"upload-image",hidden:!0,accept:"image/*",type:"file",onChange:e=>{let t=e.target.files[0];if(!t){console.error("No file selected."),I("");return}let r=new FileReader;r.onloadend=()=>{I(r.result)},r.readAsDataURL(t)}})]})]}),(0,n.jsxs)(d.ZP,{container:!0,spacing:2,alignItems:"center",sx:{pt:2},children:[(0,n.jsx)(d.ZP,{item:!0,xs:12,sm:6,sx:{pr:2,pl:2},children:(0,n.jsx)(x.Z,{variant:"contained",fullWidth:!0,onClick:()=>D(f),children:"ยืนยัน"})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,sm:6,sx:{pr:2,pl:2},children:(0,n.jsx)(x.Z,{variant:"contained",fullWidth:!0,onClick:()=>{e.push({pathname:"/cart"})},style:{background:"#AFAFAF"},children:"ยกเลิก"})})]})]})})})})})}}},function(e){e.O(0,[2607,9078,7393,6298,6886,505,3717,3914,7451,806,9774,2888,179],function(){return e(e.s=35152)}),_N_E=e.O()}]);