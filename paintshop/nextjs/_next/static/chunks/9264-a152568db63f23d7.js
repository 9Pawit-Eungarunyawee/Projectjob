"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9264],{39264:function(e,n,r){r.r(n),r.d(n,{default:function(){return R}});var t=r(85893),l=r(67294),i=r(90948),c=r(7906),s=r(295),a=r(98102),d=r(89755),o=r(72882),h=r(53184),u=r(53816),x=r(90629),j=r(50657),g=r(37645),p=r(31425),Z=r(83321),m=r(93946),f=r(87357),b=r(57922),C=r(24661),S=r(27110),k=r(77957),w=r(25675),P=r.n(w),_=r(11163),z=r(41733),N=r(60533),y=r(75503),v=r(90813);function R(e){let{data:n,onDelete:r}=e,w=(0,_.useRouter)(),R=e=>{w.push({pathname:"/product/editproduct",query:{product_id:JSON.stringify(e)}})},E=(0,i.ZP)(a.Z)(e=>{let{theme:n}=e;return{["&.".concat(d.Z.head)]:{backgroundColor:"#018294",color:n.palette.common.white},["&.".concat(d.Z.body)]:{fontSize:14}}}),I=(0,i.ZP)(u.Z)(e=>{let{theme:n}=e;return{"&:nth-of-type(odd)":{backgroundColor:n.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}}),[F,O]=l.useState([]);l.useEffect(()=>{n&&n.data&&O(n.data.sort((e,n)=>new Date(n.create.createAt)-new Date(e.create.createAt))),console.log("doc มา table: ",n)},[n]);let{buyData:A}=l.useContext(N.h),D=F.map((e,n)=>{var r,t,l;return r=e.id,t=e.img,l=e.name,{No:n+1,id:r,img:t,p_name:l,p_sell:null,p_left:null,productSizes:e.productSizes,status:!0===e.status?"พร้อมขาย":"ไม่พร้อมขาย",create:e.create}}),[M,q]=l.useState(0),[B,J]=l.useState(5),[T,W]=l.useState(!1),[G,H]=l.useState(null),K=e=>{W(!0),H(e)},L=()=>{W(!1)},Q=(e,n)=>{let r=e.flatMap(e=>e.products.filter(r=>r.product_id===n&&"สำเร็จ"===e.status));if(!(r.length>0))return"ไม่มีสินค้า";{let e=r.reduce((e,n)=>e+n.product_size.reduce((e,n)=>e+parseInt(n.amount),0),0);return 0===e?"ไม่มีสินค้า":e}},U=(e,n,r)=>{let t=e.flatMap(e=>e.products.filter(r=>r.product_id===n&&"สำเร็จ"===e.status));if(!(t.length>0))return"ไม่มีสินค้า";{let e=t.reduce((e,n)=>{let t=n.product_size.filter(e=>e.size===r).reduce((e,n)=>e+parseInt(n.amount),0);return e+t},0);return 0!==e?e:"ไม่มีสินค้า"}},[V,X]=l.useState([]),Y=e=>{X(n=>({...n,[e]:!n[e]}))};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(j.Z,{open:T,onClose:L,children:[(0,t.jsx)(g.Z,{children:"ยืนยันที่จะลบหรือไม่?"}),(0,t.jsxs)(p.Z,{children:[(0,t.jsx)(Z.Z,{onClick:L,children:"ยกเลิก"}),(0,t.jsx)(Z.Z,{onClick:()=>{r(G),W(!1)},autoFocus:!0,children:"ยืนยัน"})]})]}),(0,t.jsx)(o.Z,{component:x.Z,sx:{borderRadius:"25px",mb:5},children:(0,t.jsxs)(c.Z,{sx:{minWidth:700},children:[(0,t.jsx)(h.Z,{children:(0,t.jsxs)(u.Z,{children:[(0,t.jsx)(E,{align:"center"}),(0,t.jsx)(E,{align:"center",children:"No."}),(0,t.jsx)(E,{align:"center",children:"รูปภาพ"}),(0,t.jsx)(E,{align:"center",children:"ชื่อสินค้า"}),(0,t.jsx)(E,{align:"center",children:"ขาย"}),(0,t.jsx)(E,{align:"center",children:"เหลือ"}),(0,t.jsx)(E,{align:"center",children:"สถานะสินค้า"}),(0,t.jsx)(E,{align:"center",children:"แก้ไข"}),(0,t.jsx)(E,{align:"center",children:"ลบ"})]})}),(0,t.jsx)(s.Z,{children:(B>0?D.slice(M*B,M*B+B):D).map(e=>(0,t.jsxs)(l.Fragment,{children:[(0,t.jsxs)(I,{children:[(0,t.jsx)(E,{children:(0,t.jsx)(m.Z,{"aria-label":"expand row",size:"small",onClick:()=>Y(e.No),children:V[e.No]?(0,t.jsx)(v.Z,{}):(0,t.jsx)(y.Z,{})})}),(0,t.jsx)(E,{component:"th",scope:"row",align:"center",children:e.No}),(0,t.jsx)(E,{align:"center",children:(0,t.jsx)(P(),{src:e.img,alt:"Product Image",priority:!0,height:"75",width:"75"})}),(0,t.jsx)(E,{align:"center",children:e.p_name}),(0,t.jsx)(E,{align:"center"}),(0,t.jsx)(E,{align:"center",children:Q(A,e.id)}),(0,t.jsx)(E,{align:"center",children:(0,t.jsx)(f.Z,{sx:{backgroundColor:"พร้อมขาย"===e.status?"rgba(169, 196, 112, 0.61)":"rgba(254, 97, 106, 0.50)",p:1,borderRadius:"10px"},children:e.status})}),(0,t.jsx)(E,{align:"center",children:(0,t.jsx)(m.Z,{color:"primary",onClick:()=>R(e.id),children:(0,t.jsx)(k.Z,{})})}),(0,t.jsx)(E,{align:"center",children:(0,t.jsx)(m.Z,{color:"primary",onClick:()=>K(e.id),children:(0,t.jsx)(z.Z,{})})})]},e.id),(0,t.jsx)(u.Z,{children:(0,t.jsx)(a.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:10,children:(0,t.jsx)(b.Z,{in:V[e.No],timeout:"auto",unmountOnExit:!0,children:(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(h.Z,{children:(0,t.jsxs)(u.Z,{children:[(0,t.jsx)(a.Z,{align:"center",children:"รูปแบบสินค้า"}),(0,t.jsx)(a.Z,{align:"center",children:"ขาย"}),(0,t.jsx)(a.Z,{align:"center",children:"เหลือ"}),(0,t.jsx)(a.Z,{align:"center",children:"ราคาขาย"})]})}),(0,t.jsx)(s.Z,{children:e.productSizes&&e.productSizes.map((n,r)=>(0,t.jsxs)(u.Z,{children:[(0,t.jsx)(a.Z,{align:"center",children:n.size}),(0,t.jsx)(a.Z,{align:"center"}),(0,t.jsx)(a.Z,{align:"center",children:U(A,e.id,n.size)}),(0,t.jsx)(a.Z,{align:"center",children:n.price})]},r))})]})})})})]},e.id))}),(0,t.jsx)(C.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsx)(S.Z,{rowsPerPageOptions:[2,5,10,25,{label:"ทั้งหมด",value:-1}],count:D.length,rowsPerPage:B,page:M,labelRowsPerPage:"รายการสินค้าต่อหน้า",onPageChange:(e,n)=>{q(n)},onRowsPerPageChange:e=>{J(parseInt(e.target.value,10)),q(0)}})})})]})})]})}}}]);