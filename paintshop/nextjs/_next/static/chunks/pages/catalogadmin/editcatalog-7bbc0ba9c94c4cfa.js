(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[640],{39945:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/catalogadmin/editcatalog",function(){return t(73883)}])},94521:function(e,r,t){"use strict";t.d(r,{Y:function(){return i},_:function(){return n}});var l=t(11802),s=t(36100),o=t(49925);let a=(0,s.ad)(l.Z);async function n(e,r){let t=null,l=null;try{let l=await (0,o.ZP)("users",r.user_id);if(l.result&&l.result.exists){let o=l.result.data().name,n={delete:{deleteAt:(0,s.Bt)(),deleteBy:o}};t=await (0,s.pl)((0,s.JU)(a,e,r.id),n,{merge:!0}),console.log("Soft delete สำเร็จ",t)}else console.log("หาข้อมูล user ใน soft del ไม่เจอ")}catch(e){console.error("เกิดข้อผิดพลาดในการ soft delete:",l=e)}return{result:t,error:l}}async function i(e,r){let t=null,l=null;try{t=await (0,s.pl)((0,s.JU)(a,e,r),{delete:null},{merge:!0}),console.log("restoreCatalog สำเร็จ",t)}catch(e){console.error("เกิดข้อผิดพลาดในการ restoreCatalog:",l=e)}return{result:t,error:l}}},84178:function(e,r,t){"use strict";t.d(r,{Lj:function(){return n},ZP:function(){return a},iU:function(){return i}});var l=t(11802),s=t(36100);let o=(0,s.ad)(l.Z);async function a(e,r){let t=null,l=null;try{let l=(0,s.JU)(o,"catalog",r.catalog_id),a=(0,s.JU)(o,"colorshade",r.colorshade_id),n={catalog_id:l,colorshade_id:a,name:r.name,code:r.code,code_name:r.codename};t=await (0,s.ET)((0,s.hJ)(o,e),n),console.log("เพิ่มข้อมูลสีสำเร็จ",t)}catch(e){console.error("เกิดข้อผิดพลาดในการเพิ่มข้อมูลสี:",l=e)}return{result:t,error:l}}async function n(e,r,t){let l=null,a=null;try{let a=(0,s.JU)(o,"colorshade",t.colorshade_id),n={colorshade_id:a,name:t.name,code:t.code,code_name:t.code_name};l=await (0,s.pl)((0,s.JU)(o,e,r),n,{merge:!0}),console.log("แก้ไขสำเร็จ",l)}catch(e){console.error("เกิดข้อผิดพลาดในการแก้ไขข้อมูล:",a=e)}return{result:l,error:a}}let i=async(e,r)=>{let t=null,l=null,a=(0,s.JU)(o,e,r);try{await (0,s.oe)(a),console.log("ลบข้อมูลสำเร็จ"),t="Success"}catch(e){console.error("เกิดข้อผิดพลาดในการลบข้อมูล:",l=e)}return{result:t,error:l}}},73883:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return P}});var l=t(85893),s=t(9913),o=t(94521),a=t(84178),n=t(11802),i=t(36100);let c=(0,i.ad)(n.Z);async function d(e,r,t){let l=null,s=null;try{l=await (0,i.pl)((0,i.JU)(c,e,r),t,{merge:!0}),console.log("แก้ไขสำเร็จ",l)}catch(e){console.error("เกิดข้อผิดพลาดในการแก้ไขข้อมูล:",s=e)}return{result:l,error:s}}var u=t(49925),x=t(68239),h=t(46901),m=t(22430),p=t(58703),g=t(87357),f=t(15861),j=t(83321),Z=t(86886),b=t(98271),v=t(34386),y=t(23279),w=t.n(y),C=t(25675),_=t.n(C),S=t(11163),k=t(67294),E=t(42801),F=t(50838),z=t(96471);function P(){let e=(0,x.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}}}),r=()=>{window.history.back()},t=(0,S.useRouter)(),n=JSON.parse(t.query.catalog_id),[i,c]=(0,k.useState)(""),[y,C]=(0,k.useState)(""),[P,U]=(0,k.useState)(""),[A,W]=(0,k.useState)(""),[J,N]=(0,k.useState)(""),[R,q]=(0,k.useState)(""),[D,I]=(0,k.useState)(!1),[L,O]=(0,k.useState)(null),[T,B]=(0,k.useState)("#fff"),[X,H]=(0,k.useState)([]),[M,Y]=(0,k.useState)([]),[$,G]=(0,k.useState)("");(0,k.useEffect)(()=>{K(),Q(),V()},[]);let K=async()=>{let{result:e,error:r}=await (0,u._N)("colorshade");if(r)console.error("Error fetching document:",r);else if(e){let r=e.docs.map(e=>({id:e.id,name:e.data().name,code:e.data().code}));H(r),B(r[0].code)}},Q=async()=>{let{result:e,error:r}=await (0,u.ZP)("catalog",n);if(r)console.error("Error fetching document:",r);else if(e){let r=e.data();c(r.name),q(r.img),C(r.detail)}},V=async()=>{let{result:e,error:r}=await (0,u.EC)("colors",n);if(r)console.error("Error fetching colors:",r);else if(e){let r=e.docs.map(e=>({id:e.id,...e.data()}));Y(r)}},ee=(e,r)=>{"clickaway"!==r&&I(!1)},er=w()(e=>{W(e)},500),et=async e=>{e.preventDefault();let r=await d("catalog",n,{name:i,img:R});r?(O((0,l.jsx)(h.Z,{severity:"success",onClose:ee,children:"เพิ่มข้อมูลสำเร็จ"})),I(!0)):(O((0,l.jsx)(h.Z,{severity:"error",onClose:ee,children:"ผิดพลาด! ไม่สามารถเพิ่มข้อมูลได้"})),I(!0))},el=(e,r)=>{G(e),B(r),console.log($)},es=async e=>{if(e.preventDefault(),console.log("colordata:",i,A,J,n,$),""===$){O((0,l.jsx)(h.Z,{severity:"error",onClose:ee,children:"กรุณาเลือกเฉดสีก่อนเพิ่มสี"})),I(!0);return}let r=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(A);if(!r){O((0,l.jsx)(h.Z,{severity:"error",onClose:ee,children:"กรุณากรอกโค้ดสีให้ถูกต้อง"})),I(!0);return}if(""!==P&&""!==A&&""!==J&&n&&$){let e=await (0,a.ZP)("colors",{catalog_id:n,code:A,codename:J,colorshade_id:$,name:P});W(""),N(""),U(""),e?(O((0,l.jsx)(h.Z,{severity:"success",onClose:ee,children:"เพิ่มสีสำเร็จ"})),I(!0),V()):(O((0,l.jsx)(h.Z,{severity:"error",onClose:ee,children:"ผิดพลาด! ไม่สามารถเพิ่มสีได้"})),I(!0))}},[eo,ea]=(0,k.useState)(!1),[en,ei]=(0,k.useState)([]),ec=e=>{ea(!0),ei(e)},{user:ed}=(0,F.Eu)(),eu=async()=>{let e={id:n,user_id:ed.uid},t=await (0,o._)("catalog",e);t?(O((0,l.jsx)(h.Z,{severity:"success",onClose:ee,children:"ลบแค็ตตาล็อกสำเร็จ"})),I(!0),setTimeout(()=>{r()},500)):(O((0,l.jsx)(h.Z,{severity:"error",onClose:ee,children:"ผิดพลาด! ไม่สามารถลบแค็ตตาล็อกได้"})),I(!0))};return(0,l.jsx)(s.Z,{children:(0,l.jsxs)(m.Z,{theme:e,children:[(0,l.jsx)(p.Z,{open:D,autoHideDuration:6e3,onClose:ee,children:L}),(0,l.jsx)(E.default,{editOpen:eo,handleEditClose:()=>{ea(!1)},color:en,colorShade:X,setOpen:I,setAlert:O,handleClose:ee,fetchAllColor:V}),(0,l.jsxs)(g.Z,{sx:{height:"100%",width:"100%",mt:5},children:[(0,l.jsx)(f.Z,{sx:{fontSize:"2rem",fontWeight:"600"},children:"แก้ไขแคตตาล็อก"}),(0,l.jsxs)(j.Z,{sx:{color:"#018294",bgcolor:"white",fontWeight:"bold",borderRadius:"50px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},onClick:r,children:[(0,l.jsx)(z.Z,{}),(0,l.jsx)(f.Z,{children:" ย้อนกลับ"})]}),(0,l.jsx)("form",{onSubmit:et,className:"form",children:(0,l.jsxs)(Z.ZP,{container:!0,spacing:0,sx:{mt:3,mb:5,backgroundColor:"#fff",p:2,borderRadius:"10px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},children:[(0,l.jsxs)(Z.ZP,{item:!0,xs:12,sm:7,children:[(0,l.jsx)(f.Z,{sx:{mt:1},children:"ชื่อแคตตาล็อก:"}),(0,l.jsx)(b.Z,{variant:"outlined",value:i,label:"ชื่อแคตตาล็อก",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>c(e.target.value)}),(0,l.jsx)(f.Z,{sx:{mt:1},children:"รายละเอียดแค็ตตาล็อก:"}),(0,l.jsx)(b.Z,{value:y,onChange:e=>C(e.target.value),variant:"outlined",label:"รายละเอียดแค็ตตาล็อก",fullWidth:!0,required:!0,rows:4,multiline:!0,size:"small",sx:{mt:1,mb:1}}),(0,l.jsxs)(g.Z,{sx:{textAlign:"left"},children:[(0,l.jsx)(f.Z,{sx:{mb:1},children:"รูปแค็ตตาล็อก:"}),(0,l.jsx)(g.Z,{children:R&&(0,l.jsx)(_(),{src:R,alt:"Uploaded Image",priority:!0,height:"200",width:"260",style:{border:"1px solid rgba(0, 0, 0, 0.50)",objectFit:"cover"}})}),(0,l.jsxs)("label",{htmlFor:"upload-image",children:[(0,l.jsx)(j.Z,{variant:"contained",component:"span",children:"เปลี่ยนรูปภาพแคตตาล็อก"}),(0,l.jsx)("input",{id:"upload-image",hidden:!0,accept:"image/*",type:"file",onChange:e=>{let r=e.target.files[0];if(!r){console.error("No file selected."),q("");return}let t=new FileReader;t.onloadend=()=>{q(t.result)},t.readAsDataURL(r)}})]})]}),(0,l.jsx)(f.Z,{sx:{mt:1},children:"เพิ่มสี:"}),(0,l.jsxs)(g.Z,{sx:{ml:2},children:[(0,l.jsxs)(g.Z,{children:[(0,l.jsx)(f.Z,{sx:{mt:1},children:"เฉดสี:"}),(0,l.jsx)(g.Z,{sx:{width:"10rem",height:"3rem",bgcolor:T,transition:"0.2s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.20)",mb:2,borderRadius:"5px"}}),(0,l.jsx)(g.Z,{sx:{display:"flex"},children:X&&X.map(e=>(0,l.jsx)(g.Z,{onClick:()=>el(e.id,e.code),sx:{bgcolor:e.code,width:"2rem",height:"3rem",transform:e.id==$?"scale(1.2)":"scale(1)",cursor:"pointer",borderRadius:"100px",transition:"0.2s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)",m:1,":hover":{transform:"scale(1.2)"}}},e.id))})]}),(0,l.jsx)("hr",{}),(0,l.jsx)(f.Z,{sx:{mt:1},children:"สี:"}),(0,l.jsxs)(g.Z,{sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},children:[(0,l.jsx)(g.Z,{sx:{width:"10rem",height:"3rem",bgcolor:A,transition:"0.2s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.20)",mb:2,borderRadius:"5px"}}),(0,l.jsx)(b.Z,{variant:"outlined",value:A,label:"โค้ดสี",size:"small",type:"color",sx:{mt:1,mb:1},onChange:e=>{let r=e.target.value;er(r)},InputLabelProps:{shrink:!0,sx:{backgroundColor:"#FFF",padding:"0 5px",zIndex:1}}}),(0,l.jsx)(b.Z,{variant:"outlined",value:P,label:"ชื่อสี",size:"small",sx:{mt:1,mb:1},onChange:e=>U(e.target.value)}),(0,l.jsx)(b.Z,{variant:"outlined",value:J,label:"โค้ดเนม",size:"small",sx:{mt:1,mb:1},onChange:e=>N(e.target.value)}),(0,l.jsx)(j.Z,{variant:"contained",sx:{mt:1,mb:1,width:"34ch",m:1},onClick:es,children:"เพิ่ม"})]})]})]}),(0,l.jsxs)(Z.ZP,{item:!0,xs:12,sm:5,children:[(0,l.jsx)(f.Z,{sx:{mt:1},children:"สีที่มีในแคตตาล็อก:"}),(0,l.jsx)(g.Z,{sx:{display:"flex",flexWrap:"wrap"},children:M&&M.map((e,r)=>(0,l.jsx)(v.Z,{arrow:!0,title:(0,l.jsxs)(k.Fragment,{children:[(0,l.jsxs)(f.Z,{color:"inherit",children:["โค้ดสี: ",e.code]}),(0,l.jsxs)(f.Z,{color:"inherit",children:["ชื่อสี: ",e.name]}),(0,l.jsxs)(f.Z,{color:"inherit",children:["โค้ดเนม: ",e.code_name]})]}),children:(0,l.jsx)(g.Z,{sx:{bgcolor:e.code,width:"2rem",height:"3rem",cursor:"pointer",borderRadius:"100px",transition:"0.1s",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)",m:1,":hover":{transform:"scale(1.2)"}},onClick:()=>ec(e)})},r))})]}),(0,l.jsxs)(Z.ZP,{item:!0,xs:12,children:[(0,l.jsx)(j.Z,{variant:"contained",color:"success",sx:{mr:2,mb:2,mt:2},type:"submit",children:"แก้ไขแค็ตตาล็อก"}),(0,l.jsx)(j.Z,{variant:"contained",color:"error",sx:{mr:2,mb:2,mt:2},onClick:eu,children:"ลบแค็ตตาล็อก"})]})]})})]})]})})}},42801:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return Z}});var l=t(85893),s=t(11463),o=t(68239),a=t(46901),n=t(50657),i=t(37645),c=t(93946),d=t(6514),u=t(98271),x=t(4178),h=t(87357),m=t(31425),p=t(83321),g=t(67294),f=t(50594),j=t(84178);function Z(e){let{editOpen:r,handleEditClose:t,color:Z,colorShade:b,setOpen:v,handleClose:y,setAlert:w,fetchAllColor:C}=e,_=(0,o.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}}}),[S,k]=(0,g.useState)(""),[E,F]=(0,g.useState)(""),[z,P]=(0,g.useState)(""),[U,A]=(0,g.useState)("");(0,g.useEffect)(()=>{null!=Z&&void 0!==Z&&(Z.colorshade_id&&Z.colorshade_id.id&&A(Z.colorshade_id.id),Z.code&&k(Z.code),Z.code_name&&F(Z.code_name),Z.name&&P(Z.name))},[Z]);let W=async e=>{e.preventDefault();let r=await (0,j.Lj)("colors",Z.id,{code:S,code_name:E,name:z,colorshade_id:U});r?(w((0,l.jsx)(a.Z,{severity:"success",onClose:y,children:"แก้ไขสีสำเร็จ"})),v(!0),t(),C()):(w((0,l.jsx)(a.Z,{severity:"error",onClose:y,children:"ผิดพลาด! ไม่สามารถแก้ไขสีได้"})),v(!0))},J=async()=>{let e=await (0,j.iU)("colors",Z.id);e?(w((0,l.jsx)(a.Z,{severity:"success",onClose:y,children:"ลบสีสำเร็จ"})),v(!0),t(),C()):(w((0,l.jsx)(a.Z,{severity:"error",onClose:y,children:"ผิดพลาด! ไม่สามารถลบสีได้"})),v(!0))};return(0,l.jsx)(s.a,{theme:_,children:(0,l.jsxs)(n.Z,{open:r,onClose:t,maxWidth:"xs",fullWidth:!0,children:[(0,l.jsx)(i.Z,{children:"แก้ไขสี"}),(0,l.jsx)(c.Z,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,l.jsx)(f.Z,{})}),(0,l.jsxs)("form",{onSubmit:W,className:"form",children:[(0,l.jsxs)(d.Z,{children:[(0,l.jsxs)(u.Z,{size:"small",select:!0,label:"เลือกเฉดสี",required:!0,fullWidth:!0,sx:{mt:1},value:U,onChange:e=>A(e.target.value),children:[(0,l.jsx)(x.Z,{children:"กรุณาเลือกเฉดสี"}),b&&b.map(e=>(0,l.jsx)(x.Z,{value:e.id,children:(0,l.jsx)(h.Z,{sx:{bgcolor:e.code,p:1,width:"100%",borderRadius:"10px"},children:e.name})},e.id))]}),(0,l.jsx)(u.Z,{variant:"outlined",value:S,label:"โค้ดสี",size:"small",type:"color",fullWidth:!0,sx:{mt:2,mb:1},onChange:e=>k(e.target.value),InputLabelProps:{shrink:!0,sx:{backgroundColor:"#FFF",padding:"0 5px",zIndex:1}}}),(0,l.jsx)(u.Z,{variant:"outlined",value:z,label:"ชื่อสี",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>P(e.target.value)}),(0,l.jsx)(u.Z,{variant:"outlined",value:E,label:"โค้ดเนม",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>F(e.target.value)})]}),(0,l.jsxs)(m.Z,{children:[(0,l.jsx)(p.Z,{variant:"contained",color:"error",onClick:J,children:"ลบ"}),(0,l.jsx)(p.Z,{variant:"contained",color:"success",type:"submit",children:"แก้ไข"})]})]})]})})}}},function(e){e.O(0,[2607,7609,5675,6298,6185,1283,3717,3914,8360,8271,4163,4792,6078,4386,103,9913,9774,2888,179],function(){return e(e.s=39945)}),_N_E=e.O()}]);