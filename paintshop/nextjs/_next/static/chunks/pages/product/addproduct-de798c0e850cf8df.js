(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6401],{66312:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/product/addproduct",function(){return l(71907)}])},34300:function(e,t,l){"use strict";l.d(t,{RS:function(){return o},SR:function(){return u},ZP:function(){return i},cB:function(){return c}});var r=l(11802),a=l(36100),n=l(49925);let s=(0,a.ad)(r.Z);async function i(e,t){let l=null,r=null,n=(0,a.JU)(s,"catalog",t.catalog_id);try{let r=t.img?t.img:"",i={name:t.name,catalog_id:n,detail:t.detail,flim:t.flim,grade:t.grade,lot:t.lot,status:t.status,img:r,area:t.area,productSizes:t.productSizes,delete:null,create:{createAt:(0,a.Bt)(),createBy:t.user_id},update:null};l=await (0,a.ET)((0,a.hJ)(s,e),i),console.log("เพิ่มข้อมูลสำเร็จ",l)}catch(e){console.error("เกิดข้อผิดพลาดในการเพิ่มข้อมูล:",r=e)}return{result:l,error:r}}let u=async(e,t)=>{let l=null,r=null,n=(0,a.JU)(s,e,t);try{await (0,a.oe)(n),console.log("ลบข้อมูลสำเร็จ"),l="Success"}catch(e){console.error("เกิดข้อผิดพลาดในการลบข้อมูล:",r=e)}return{result:l,error:r}};async function o(e,t){let l=null,r=null;try{let r=await (0,n.ZP)("users",t.user_id);if(r.result&&r.result.exists){let n=r.result.data().name,i={delete:{deleteAt:(0,a.Bt)(),deleteBy:n}};l=await (0,a.pl)((0,a.JU)(s,e,t.id),i,{merge:!0}),console.log("Soft delete สำเร็จ",l)}else console.log("หาข้อมูล user ใน soft del ไม่เจอ")}catch(e){console.error("เกิดข้อผิดพลาดในการ soft delete:",r=e)}return{result:l,error:r}}async function c(e,t){let l=null,r=null;try{l=await (0,a.pl)((0,a.JU)(s,e,t),{delete:null},{merge:!0}),console.log("restoreData สำเร็จ",l)}catch(e){console.error("เกิดข้อผิดพลาดในการ restoreData:",r=e)}return{result:l,error:r}}},49925:function(e,t,l){"use strict";l.d(t,{EC:function(){return u},Eq:function(){return c},KL:function(){return o},PR:function(){return d},ZP:function(){return s},_N:function(){return i},wv:function(){return x}});var r=l(11802),a=l(36100);let n=(0,a.ad)(r.Z);async function s(e,t){let l=(0,a.JU)(n,e,t);try{let e=await (0,a.QT)(l);return{result:e,error:null}}catch(e){return{result:null,error:e}}}let i=async e=>{let t=await (0,a.PL)((0,a.hJ)(n,e));return{result:t,error:null}},u=async(e,t)=>{let l=(0,a.JU)(n,"catalog",t),r=(0,a.IO)((0,a.hJ)(n,e),(0,a.ar)("catalog_id","==",l)),s=await (0,a.PL)(r);return{result:s,error:null}},o=async e=>{let t=[];for(let l of e){let e=await (0,a.QT)((0,a.JU)(n,"products",l));if(e.exists()){let r=e.data(),a={id:l,...r};t.push(a)}}return t},c=async e=>{let t=[];for(let l of e){let e=await (0,a.QT)((0,a.JU)(n,"colors",l));if(e.exists()){let r=e.data(),a={id:l,...r};t.push(a)}}return t},d=async(e,t)=>{let l=(0,a.IO)((0,a.hJ)(n,e),(0,a.ar)("uid","==",String(t))),r=await (0,a.PL)(l);return r.forEach(e=>{console.log(e.id," => ",e.data())}),{result:r,error:null}},x=async(e,t)=>{let l=(0,a.JU)(n,"catalog",t),r=await (0,a.QT)(l);if(!r.exists())return console.error("Catalog document not found"),{result:null,error:"Catalog document not found"};let s=(0,a.IO)((0,a.hJ)(n,e),(0,a.ar)("catalog_id","==",l));try{let e=await (0,a.PL)(s);return e.forEach(e=>{console.log(e.id," => ",e.data())}),{result:e,error:null}}catch(e){return console.error("Error getting products: ",e),{result:null,error:e}}}},71907:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return S}});var r=l(85893),a=l(98010),n=l(49925),s=l(34300),i=l(50838),u=l(68239),o=l(46901),c=l(22430),d=l(58703),x=l(15861),h=l(83321),m=l(86886),f=l(94054),g=l(10945),p=l(4178),Z=l(87357),j=l(50480),v=l(85071),b=l(96471),y=l(25675),w=l.n(y),C=l(67294);function S(){let{user:e}=(0,i.Eu)(),[t,l]=(0,C.useState)(""),[y,S]=(0,C.useState)([{size:"",quantity:"",price:"",cost:""}]),[_,z]=(0,C.useState)(""),[q,E]=(0,C.useState)(!1),[J,P]=(0,C.useState)(""),[k,W]=(0,C.useState)(""),[U,N]=(0,C.useState)(""),[R,I]=(0,C.useState)(""),[T,A]=(0,C.useState)(""),[L,B]=(0,C.useState)(""),[D,O]=(0,C.useState)(null),Q=(0,u.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}}});(0,C.useEffect)(()=>{console.log(y)},[y]);let F=(e,t,l)=>{let r=[...y];r[t][l]=e.target.value,S(r)},$=e=>{if(y.length>1){let t=[...y];t.splice(e,1),S(t)}else y.length<=1&&(O((0,r.jsx)(o.Z,{severity:"error",onClose:Y,children:"ต้องมีรูปแบบสินค้าอย่างน้อย 1 รูปแบบ"})),V(!0))};(0,C.useEffect)(()=>{K()},[]);let[X,H]=(0,C.useState)(null),K=async()=>{let{result:e,error:t}=await (0,n._N)("catalog");if(t)console.error("Error fetching document:",t);else if(e){let t=e.docs.map(e=>({id:e.id,name:e.data().name}));H(t)}},G=async l=>{l.preventDefault();let a={name:J,catalog_id:k,detail:L,flim:U,grade:R,lot:T,area:_,status:q,img:t,productSizes:y,user_id:e.uid},n=await (0,s.ZP)("products",a);n?(O((0,r.jsx)(o.Z,{severity:"success",onClose:Y,children:"เพิ่มข้อมูลสำเร็จ"})),V(!0)):(O((0,r.jsx)(o.Z,{severity:"error",onClose:Y,children:"ผิดพลาด! ไม่สามารถเพิ่มข้อมูลได้"})),V(!0))},[M,V]=(0,C.useState)(!1),Y=(e,t)=>{"clickaway"!==t&&V(!1)};return(0,r.jsx)(a.Z,{children:(0,r.jsxs)(c.Z,{theme:Q,children:[(0,r.jsx)(d.Z,{open:M,autoHideDuration:6e3,onClose:Y,children:D}),(0,r.jsx)(x.Z,{sx:{fontSize:"2rem",fontWeight:"600",mt:4},children:"เพิ่มสินค้า"}),(0,r.jsxs)(h.Z,{sx:{color:"#018294",bgcolor:"white",fontWeight:"bold",borderRadius:"50px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},onClick:()=>{window.history.back()},children:[(0,r.jsx)(b.Z,{}),(0,r.jsx)(x.Z,{children:" ย้อนกลับ"})]}),(0,r.jsx)(m.ZP,{container:!0,spacing:0,sx:{mt:3,mb:5,backgroundColor:"#fff",p:2,borderRadius:"10px",boxShadow:"4px 4px 4px 0px rgba(0, 0, 0, 0.25)"},children:(0,r.jsx)(m.ZP,{item:!0,xs:12,sm:7,children:(0,r.jsxs)("form",{onSubmit:G,className:"form",children:[(0,r.jsxs)(f.Z,{fullWidth:!0,children:[(0,r.jsx)(x.Z,{children:"แคตตาล็อก:"}),(0,r.jsxs)(g.Z,{value:k,onChange:e=>W(e.target.value),size:"small",select:!0,label:"เลือกแคตตาล็อก",required:!0,children:[(0,r.jsx)(p.Z,{value:"",children:"กรุณาเลือกแคตตาล็อก"}),X&&X.map(e=>(0,r.jsx)(p.Z,{value:e.id,children:e.name},e.id))]}),(0,r.jsx)(x.Z,{sx:{mt:1},children:"ข้อมูลสินค้า:"}),(0,r.jsx)(g.Z,{variant:"outlined",value:J,label:"ชื่อสินค้า",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},onChange:e=>P(e.target.value)}),(0,r.jsxs)(g.Z,{value:_,onChange:e=>z(e.target.value),size:"small",select:!0,label:"พื้นที่ใช้งาน",sx:{mt:1,mb:1},required:!0,children:[(0,r.jsx)(p.Z,{value:"สีทาภายนอก",children:"สีทาภายนอก"}),(0,r.jsx)(p.Z,{value:"สีทาภายใน",children:"สีทาภายใน"}),(0,r.jsx)(p.Z,{value:"สีน้ำมัน",children:"สีน้ำมัน"}),(0,r.jsx)(p.Z,{value:"สีย้อมไม้",children:"สีย้อมไม้"})]}),(0,r.jsxs)(g.Z,{value:U,onChange:e=>N(e.target.value),size:"small",select:!0,label:"ฟิล์ม",sx:{mt:1,mb:1},required:!0,children:[(0,r.jsx)(p.Z,{value:"ฟิล์มสีชนิดเงา",children:"ฟิล์มสีชนิดเงา"}),(0,r.jsx)(p.Z,{value:"ฟิล์มสีชนิดกึ่งเงา",children:"ฟิล์มสีชนิดกึ่งเงา"}),(0,r.jsxs)(p.Z,{value:"ฟิล์มสีชนิดเนียน",children:["ฟิล์มสีชนิดเนียน"," "]}),(0,r.jsx)(p.Z,{value:"ฟิล์มสีชนิดด้าน",children:"ฟิล์มสีชนิดด้าน"})]}),(0,r.jsxs)(g.Z,{value:R,onChange:e=>I(e.target.value),size:"small",select:!0,label:"เกรด",sx:{mt:1,mb:1},required:!0,children:[(0,r.jsx)(p.Z,{value:"เกรดอัลตร้าพรีเมี่ยม อายุการใช้งาน 15 ปี",children:"เกรดอัลตร้าพรีเมี่ยม อายุการใช้งาน 15 ปี"}),(0,r.jsx)(p.Z,{value:"เกรดพรีเมี่ยม อายุการใช้งาน 10 ปี",children:"เกรดพรีเมี่ยม อายุการใช้งาน 10 ปี"}),(0,r.jsx)(p.Z,{value:"เกรดมาตรฐานบน 5-7 ปี",children:"เกรดมาตรฐานบน 5-7 ปี"}),(0,r.jsx)(p.Z,{value:"เกรดมาตรฐาน 3-5 ปี",children:"เกรดมาตรฐาน 3-5 ปี"}),(0,r.jsx)(p.Z,{value:"เกรดประหยัด 1-3 ปี",children:"เกรดประหยัด 1-3 ปี"})]}),(0,r.jsx)(g.Z,{value:L,onChange:e=>B(e.target.value),variant:"outlined",label:"รายละเอียดสินค้า",fullWidth:!0,required:!0,rows:4,multiline:!0,size:"small",sx:{mt:1,mb:1}}),(0,r.jsx)(x.Z,{children:" รูปแบบสินค้า: "}),(0,r.jsx)(h.Z,{variant:"contained",fullWidth:!0,sx:{mr:2,mb:2,mt:2,width:"200px"},onClick:()=>{S([...y,{size:"",quantity:"",price:"",cost:""}])},children:"เพิ่มรูปแบบสินค้า"}),y.map((e,t)=>(0,r.jsxs)(Z.Z,{sx:{borderRadius:"10px",mb:3,p:2,boxShadow:"rgba(6, 24, 44, 0.4) 0px 0px 0px 2px, rgba(6, 24, 44, 0.65) 0px 4px 6px -1px, rgba(255, 255, 255, 0.08) 0px 1px 0px inset"},children:[(0,r.jsxs)(x.Z,{children:[" รูปแบบที่:",t+1," "]}),(0,r.jsxs)(g.Z,{value:e.size,onChange:e=>F(e,t,"size"),size:"small",select:!0,fullWidth:!0,label:"ขนาด",sx:{mt:1,mb:1},required:!0,children:[(0,r.jsx)(p.Z,{value:"",children:"กรุณาเลือกขนาดบรรจุ"}),(0,r.jsx)(p.Z,{value:"1/4 แกลลอน",children:"1/4 แกลลอน"}),(0,r.jsx)(p.Z,{value:"1 แกลลอน",children:"1 แกลลอน"}),(0,r.jsx)(p.Z,{value:"2.5 แกลลอน",children:"2.5 แกลลอน"}),(0,r.jsx)(p.Z,{value:"5 แกลลอน",children:"5 แกลลอน"})]}),(0,r.jsx)(g.Z,{value:e.quantity,onChange:e=>{let l=e.target.value;(/^\d*$/.test(l)||""===l)&&(""===l||parseInt(l)>=0&&"0"!==l[0])&&F(e,t,"quantity")},variant:"outlined",label:"จำนวน",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1}}),(0,r.jsx)(g.Z,{value:e.price,variant:"outlined",label:"ราคา",onChange:e=>{let l=e.target.value;(/^\d*$/.test(l)||""===l)&&(""===l||parseInt(l)>=0&&"0"!==l[0])&&F(e,t,"price")},fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1}}),(0,r.jsx)(g.Z,{value:e.cost,onChange:e=>{let l=e.target.value;(/^\d*$/.test(l)||""===l)&&(""===l||parseInt(l)>=0&&"0"!==l[0])&&F(e,t,"cost")},variant:"outlined",label:"ต้นทุน",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1}}),(0,r.jsx)(h.Z,{variant:"contained",color:"error",fullWidth:!0,onClick:()=>$(t),children:"ลบ"})]},t)),(0,r.jsxs)(Z.Z,{sx:{textAlign:"left"},children:[(0,r.jsx)(x.Z,{sx:{mb:1},children:"รูปภาพสินค้า:"}),(0,r.jsx)(Z.Z,{children:t&&(0,r.jsx)(w(),{src:t,alt:"Uploaded Image",priority:!0,height:"150",width:"150",style:{border:"1px solid rgba(0, 0, 0, 0.50)"}})}),(0,r.jsxs)("label",{htmlFor:"upload-image",children:[(0,r.jsx)(h.Z,{variant:"contained",component:"span",children:"เพิ่มรูปภาพสินค้า"}),(0,r.jsx)("input",{id:"upload-image",hidden:!0,accept:"image/*",type:"file",onChange:e=>{let t=e.target.files[0];if(!t){console.error("No file selected."),l("");return}let r=new FileReader;r.onloadend=()=>{l(r.result)},r.readAsDataURL(t)}})]})]}),(0,r.jsx)(x.Z,{sx:{mt:1},children:"ล๊อตสินค้า:"}),(0,r.jsx)(g.Z,{value:T,onChange:e=>A(e.target.value),variant:"outlined",fullWidth:!0,required:!0,size:"small",sx:{mt:1,mb:1},type:"date"}),(0,r.jsx)(Z.Z,{children:(0,r.jsx)(j.Z,{sx:{m:0},control:(0,r.jsx)(v.Z,{checked:q,onChange:e=>{E(e.target.checked)}}),label:"เปิดให้สั่งซื้อ:",labelPlacement:"start"})})]}),(0,r.jsx)(h.Z,{variant:"contained",color:"success",sx:{mr:2,mb:2,mt:2},type:"submit",children:"เพิ่มสินค้า"})]})})})]})})}}},function(e){e.O(0,[2607,9078,7393,6298,6886,505,3717,3914,945,4792,1784,8010,9774,2888,179],function(){return e(e.s=66312)}),_N_E=e.O()}]);