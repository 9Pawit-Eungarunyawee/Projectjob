(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[228],{63598:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/buy",function(){return r(17456)}])},726:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(36100),a=r(11802);let s=(0,n.ad)(a.Z);async function i(e,t,r){try{let a=t.toLowerCase(),i=r.toLowerCase(),l=(0,n.IO)((0,n.hJ)(s,e),(0,n.Xo)(a)),c=await (0,n.PL)(l),d=c.docs.filter(e=>{let t=e.data()[a];return t&&-1!==t.toLowerCase().indexOf(i)}).map(e=>({id:e.id,...e.data()}));return d}catch(e){throw console.error("Error searching data:",e),e}}},17456:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(85893),a=r(9913);r(49925);var s=r(726),i=r(87357),l=r(68239),c=r(22430),d=r(15861),o=r(98271),u=r(87109),h=r(83321),x=r(88409),j=r(40044),f=r(23279),p=r.n(f),Z=r(67294),m=r(42761),g=r(24930);r(99061);var b=r(41664),v=r.n(b),w=r(45697),y=r.n(w),C=r(60533);function P(e){let{children:t,value:r,index:a,...s}=e;return(0,n.jsx)(i.Z,{role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a),...s,children:r===a&&(0,n.jsx)(i.Z,{sx:{pt:2,mb:5},children:(0,n.jsx)(i.Z,{children:t})})})}function _(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function E(){let e=(0,l.Z)({palette:{primary:{main:"#018294"},success:{main:"#A9C470"},error:{main:"#FE616A"}}}),[t,r]=(0,Z.useState)(0),[f,b]=(0,Z.useState)(""),w=p()(async e=>{try{let t=await (0,s.Z)("buy","name",e),r=t.sort((e,t)=>t.createAt.toMillis()-e.createAt.toMillis());S(r)}catch(e){console.error("Error searching data:",e)}},500),y=e=>{b(e),w(e)},{buyData:E,setBuyData:S,fetchBuyData:N}=(0,Z.useContext)(C.h);return(0,Z.useEffect)(()=>{N()},[]),(0,n.jsx)(a.Z,{children:(0,n.jsxs)(c.Z,{theme:e,children:[(0,n.jsxs)(i.Z,{sx:{height:"100%",width:"100%",mt:5},variant:"div",children:[(0,n.jsx)(d.Z,{sx:{fontSize:"2rem",fontWeight:"600"},children:"รายการซื้อ"}),(0,n.jsx)(i.Z,{sx:{mt:1},children:(0,n.jsx)(o.Z,{label:"ค้นหา",variant:"outlined",size:"small",onChange:e=>y(e.target.value),InputProps:{startAdornment:(0,n.jsx)(u.Z,{position:"start",children:(0,n.jsx)(m.Z,{sx:{fontSize:"1.4rem"}})})}})})]}),(0,n.jsx)(i.Z,{sx:{display:"flex",justifyContent:{xl:"flex-end"}},children:(0,n.jsx)(v(),{href:"/buy/add",passHref:!0,children:(0,n.jsx)(h.Z,{variant:"contained",color:"success",sx:{mr:2,mt:2},children:"สร้างรายการซื้อ"})})}),(0,n.jsxs)(i.Z,{sx:{width:"100%"},children:[(0,n.jsx)(i.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,n.jsxs)(x.Z,{value:t,onChange:(e,t)=>{r(t)},"aria-label":"basic tabs example",children:[(0,n.jsx)(j.Z,{label:(0,n.jsx)(d.Z,{children:"ทั้งหมด"}),..._(0)}),(0,n.jsx)(j.Z,{label:(0,n.jsx)(d.Z,{children:"สำเร็จ"}),..._(1)}),(0,n.jsx)(j.Z,{label:(0,n.jsx)(d.Z,{children:"ยกเลิก"}),..._(2)})]})}),(0,n.jsx)(P,{value:t,index:0,children:(0,n.jsx)(g.default,{data:{data:E}})}),(0,n.jsx)(P,{value:t,index:1,children:(0,n.jsx)(g.default,{data:{data:E.filter(e=>"สำเร็จ"===e.status)}})}),(0,n.jsx)(P,{value:t,index:2,children:(0,n.jsx)(g.default,{data:{data:E.filter(e=>"ยกเลิก"===e.status)}})})]})]})})}P.propTypes={children:y().node,index:y().number.isRequired,value:y().number.isRequired}},24930:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=r(85893),a=r(49925),s=r(90948),i=r(98102),l=r(89755),c=r(53816),d=r(72882),o=r(90629),u=r(7906),h=r(53184),x=r(295),j=r(87357),f=r(83321),p=r(24661),Z=r(27110);r(25675);var m=r(11163),g=r(67294);function b(e){let{data:t}=e,r=(0,m.useRouter)(),b=(0,s.ZP)(i.Z)(e=>{let{theme:t}=e;return{["&.".concat(l.Z.head)]:{backgroundColor:"#018294",color:t.palette.common.white},["&.".concat(l.Z.body)]:{fontSize:14}}}),v=(0,s.ZP)(c.Z)(e=>{let{theme:t}=e;return{"&:nth-of-type(odd)":{backgroundColor:t.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}}),[w,y]=(0,g.useState)([]);(0,g.useEffect)(()=>{t&&t.data&&y(t.data),console.log("doc มา table: ",t)},[t]);let[C,P]=(0,g.useState)([]);(0,g.useEffect)(()=>{_()},[]);let _=async()=>{let{result:e,error:t}=await (0,a._N)("users");if(t)console.error("Error fetching document:",t);else if(e){let t=e.docs.map(e=>({id:e.id,...e.data()}));P(t)}},E=w.map((e,t)=>{var r,n,a;let s=C.find(t=>t.id===e.user_id),i=s?s.name:"";return r=e.id,n=e.name,a=e.totalCost,{No:t+1,id:r,name:n,totalCost:a,createAt:e.createAt,user:i,products:e.products,status:e.status}}),[S,N]=(0,g.useState)(0),[k,A]=(0,g.useState)(5);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(d.Z,{component:o.Z,sx:{borderRadius:"25px"},children:(0,n.jsxs)(u.Z,{sx:{minWidth:700},children:[(0,n.jsx)(h.Z,{children:(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(b,{children:"No."}),(0,n.jsx)(b,{align:"center",children:"วันที่"}),(0,n.jsx)(b,{align:"center",children:"ชื่อรายการ"}),(0,n.jsx)(b,{align:"center",children:"ผู้สร้าง"}),(0,n.jsx)(b,{align:"center",children:"มูลค่า(บาท)"}),(0,n.jsx)(b,{align:"center",children:"สถานะ"}),(0,n.jsx)(b,{align:"center"})]})}),(0,n.jsx)(x.Z,{children:(k>0?E.slice(S*k,S*k+k):E).map(e=>(0,n.jsxs)(v,{children:[(0,n.jsx)(b,{component:"th",scope:"row",children:e.No}),(0,n.jsx)(b,{align:"center",children:e.createAt.toDate().toLocaleString("th-TH",{dateStyle:"medium"})}),(0,n.jsx)(b,{align:"center",children:e.name}),(0,n.jsx)(b,{align:"center",children:e.user}),(0,n.jsx)(b,{align:"center",children:e.totalCost}),(0,n.jsx)(b,{align:"center",children:(0,n.jsx)(j.Z,{sx:{backgroundColor:"สำเร็จ"===e.status?"rgba(169, 196, 112, 0.61)":"rgba(254, 97, 106, 0.50)",p:1,borderRadius:"10px"},children:e.status})}),(0,n.jsx)(b,{align:"center",children:(0,n.jsx)(f.Z,{onClick:()=>{var t;return t=e.id,void r.push({pathname:"buy/detail",query:{id:JSON.stringify(t)}})},children:"ดูรายละเอียด"})})]},e.No))}),(0,n.jsx)(p.Z,{children:(0,n.jsx)(c.Z,{children:(0,n.jsx)(Z.Z,{rowsPerPageOptions:[2,5,10,25,{label:"ทั้งหมด",value:-1}],count:E.length,rowsPerPage:k,page:S,labelRowsPerPage:"รายการสินค้าต่อหน้า",onPageChange:(e,t)=>{N(t)},onRowsPerPageChange:e=>{A(parseInt(e.target.value,10)),N(0)}})})})]})})})}}},function(e){e.O(0,[2607,7609,5675,6298,6185,1283,3717,3914,8360,8271,9254,1990,837,5315,9913,9774,2888,179],function(){return e(e.s=63598)}),_N_E=e.O()}]);